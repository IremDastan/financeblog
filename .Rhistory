select(-DATE) %>%
pivot_wider(names_from = "EventDay", values_from = "AR") %>%
mutate(
AAR = rowMeans(.[,-c(1,2)], na.rm = TRUE)
) %>%
group_by(Ticker) %>%
mutate(
CAR = cumsum(AAR)
) %>%
ungroup()
master <- data.frame()
before <- 10
after <- 10
master <- data.frame()
for(i in 1:length(ticker)) {
for (j in 1:length(eventday)) {
finalFilter <- df_daily %>%
arrange(Ticker) %>%
group_by(Ticker) %>%
mutate(ID = row_number()) %>%
filter(Ticker == ticker[i])
id <- finalFilter %>%
filter(DATE == as.Date(eventday[j])) %>%
pull(ID)
final <- finalFilter %>%
filter(ID >= (id - before) & ID <= (id + after)) %>%
mutate(DATE = as.Date(DATE)) %>%
dplyr::select(DATE, Ticker, AR) %>%
mutate(EventDay = eventday[j])
master <- master %>% bind_rows(final)
}
}
master2 <- master %>%
group_by(Ticker,EventDay) %>%
mutate(
day = seq(before*-1,after,1)
) %>%
ungroup() %>%
select(-DATE) %>%
pivot_wider(names_from = "EventDay", values_from = "AR") %>%
mutate(
AAR = rowMeans(.[,-c(1,2)], na.rm = TRUE)
) %>%
group_by(Ticker) %>%
mutate(
CAR = cumsum(AAR)
) %>%
ungroup()
openxlsx::write.xlsx(master2,"eventDayCBRT10.xlsx")
ggplot(master2, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
theme_minimal() +
facet_wrap(~Ticker, scales = "free_y")
master3 <- master %>%
group_by(Ticker,EventDay) %>%
mutate(
day = seq(before*-1,after,1)
) %>%
ungroup() %>%
group_by(day) %>%
summarise(
AAR = mean(AR, na.rm = TRUE)
) %>%
ungroup() %>%
mutate(
CAR = cumsum(AAR)
)
openxlsx::write.xlsx(master3,"eventDayCBRT10_ALL.xlsx")
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
theme_minimal()
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return")
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal()
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_point() +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
View(master3)
sigma_cbrt <- sd(master3$AAR)
car_sum_cbrt <- sum(master3$CAR)
car_tstat_cbrt <- car_sum_cbrt / (sigma_cbrt * sqrt(nrow(master3)))
master3 <- master3 %>%
mutate(
t = seq(before*-1,after,1)
)
View(master3)
master3 <- master3 %>%
mutate(
t = seq(before*-1,after,1),
t_stat = CAR / sigma_cbrt * sqrt(abs(t))
)
View(master3)
master3 <- master3 %>%
mutate(
t = seq(before*-1,after,1),
t_stat = CAR / sigma_cbrt * sqrt(abs(t)),
result = ifelse(abs(t_stat) > 1.96, "SIGNIFICANT","INSIGNIFICANT")
)
View(master3)
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_point(aes(color = result)) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_point(aes(color = result), size = 5) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_point(aes(color = result), size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "gray60") +
geom_point(aes(color = result), size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "gray60") +
geom_point(aes(color = result), size = 3) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "gray60") +
geom_point(aes(color = result), size = 3) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.title = element_blank())
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = 'C:/Users/\u0130rem/Desktop/FB513-Project')
setwd('C:/Users/\u0130rem/Desktop/FB513-Project')
library(readxl);library(tidyverse);library(openxlsx);library(data.table);library(zoo)
# Daily stock data import
Daily_Stock <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - stock") %>%
mutate(ASELS = na.locf(ASELS)) %>%
pivot_longer(!DATE, names_to = "Ticker",values_to = "LastPriceTicker")
# Daily index data import
Daily_Index <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - index")
# Daily stock data import
Daily_Stock <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - stock") %>%
mutate(ASELS = na.locf(ASELS)) %>%
pivot_longer(!DATE, names_to = "Ticker",values_to = "LastPriceTicker")
# Daily index data import
Daily_Index <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - index")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = 'C:/Users/\u0130rem/Desktop/FB513-Project')
setwd('C:/Users/\u0130rem/Desktop/FB513-Project')
library(readxl);library(tidyverse);library(openxlsx);library(data.table);library(zoo)
# Daily stock data import
Daily_Stock <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - stock") %>%
mutate(ASELS = na.locf(ASELS)) %>%
pivot_longer(!DATE, names_to = "Ticker",values_to = "LastPriceTicker")
# Daily index data import
Daily_Index <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - index")
# Daily stock data import
Daily_Stock <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - stock") %>%
mutate(ASELS = na.locf(ASELS)) %>%
pivot_longer(!DATE, names_to = "Ticker",values_to = "LastPriceTicker")
# Daily index data import
Daily_Index <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - index")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
knitr::opts_knit$set(root.dir = 'C:/Users/\u0130rem/Desktop/FB513-Project')
setwd('C:/Users/\u0130rem/Desktop/FB513-Project')
library(readxl);library(tidyverse);library(openxlsx);library(data.table);library(zoo)
# Daily stock data import
Daily_Stock <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - stock") %>%
mutate(ASELS = na.locf(ASELS)) %>%
pivot_longer(!DATE, names_to = "Ticker",values_to = "LastPriceTicker")
# Daily index data import
Daily_Index <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "daily - index")
Daily_Stock <- Daily_Stock %>%
arrange(Ticker) %>%
group_by(Ticker) %>%
mutate(lagLastPriceTicker=shift(LastPriceTicker, 1, type= "lag"),
perReturnTicker= (LastPriceTicker-lagLastPriceTicker)/lagLastPriceTicker,
logReturnTicker= log(LastPriceTicker/lagLastPriceTicker)) %>%
ungroup()
ggplot(Daily_Stock, aes(x=DATE, y=perReturnTicker, group= Ticker)) +
geom_line(color="#80d7cc") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Return")
# Calculating the BIST100-Index Return
Daily_Index <- Daily_Index %>%
mutate(lagXU100=shift(XU100, 1, type= "lag"),
perReturnXU100= (XU100-lagXU100)/lagXU100,
logReturnXU100= log(XU100/lagXU100))
ggplot(Daily_Index, aes(x=DATE, y=perReturnXU100)) +
geom_line(color="orange") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "bold", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("XU100 Index Return")
df_daily <- Daily_Stock %>%
left_join(Daily_Index, by = "DATE") %>%
mutate(AR = perReturnTicker - perReturnXU100,
DATE = as.Date(DATE)) %>%
arrange(Ticker,DATE)
# Importing the event days
df_EventDay <- read_excel("C:/Users/İrem/Desktop/FB513-Project/FB513_data.xlsx", sheet = "announcement") %>% arrange(DATE)
ticker <- df_daily %>% select(Ticker) %>% distinct() %>% pull(Ticker)
eventday <- df_EventDay %>% pull(DATE) %>% as.Date()
before <- 10
after <- 10
master <- data.frame()
for(i in 1:length(ticker)) {
for (j in 1:length(eventday)) {
finalFilter <- df_daily %>%
arrange(Ticker) %>%
group_by(Ticker) %>%
mutate(ID = row_number()) %>%
filter(Ticker == ticker[i])
id <- finalFilter %>%
filter(DATE == as.Date(eventday[j])) %>%
pull(ID)
final <- finalFilter %>%
filter(ID >= (id - before) & ID <= (id + after)) %>%
mutate(DATE = as.Date(DATE)) %>%
dplyr::select(DATE, Ticker, AR) %>%
mutate(EventDay = eventday[j])
master <- master %>% bind_rows(final)
}
}
master2 <- master %>%
group_by(Ticker,EventDay) %>%
mutate(
day = seq(before*-1,after,1)
) %>%
ungroup() %>%
select(-DATE) %>%
pivot_wider(names_from = "EventDay", values_from = "AR") %>%
mutate(
AAR = rowMeans(.[,-c(1,2)], na.rm = TRUE)
) %>%
group_by(Ticker) %>%
mutate(
CAR = cumsum(AAR)
) %>%
ungroup()
openxlsx::write.xlsx(master2,"eventDayCBRT10.xlsx")
ggplot(master2, aes(x = day, y = CAR)) +
geom_line(color = "red") +
geom_vline(xintercept = 0, linetype = "dashed") +
theme_minimal() +
facet_wrap(~Ticker, scales = "free_y")
master3 <- master %>%
group_by(Ticker,EventDay) %>%
mutate(
day = seq(before*-1,after,1)
) %>%
ungroup() %>%
group_by(day) %>%
summarise(
AAR = mean(AR, na.rm = TRUE)
) %>%
ungroup() %>%
mutate(
CAR = cumsum(AAR)
)
sigma_cbrt <- sd(master3$AAR)
car_sum_cbrt <- sum(master3$CAR)
car_tstat_cbrt <- car_sum_cbrt / (sigma_cbrt * sqrt(nrow(master3)))
master3 <- master3 %>%
mutate(
t = seq(before*-1,after,1),
t_stat = CAR / sigma_cbrt * sqrt(abs(t)),
result = ifelse(abs(t_stat) > 1.96, "SIGNIFICANT","INSIGNIFICANT")
)
ifelse(abs(car_tstat_cbrt) > 1.96, "Significant", "Insignificant")
openxlsx::write.xlsx(master3,"eventDayCBRT10_ALL.xlsx")
ggplot(master3, aes(x = day, y = CAR)) +
geom_line(color = "gray60") +
geom_point(aes(color = result), size = 3) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0) +
labs(title = "Cumulative Abnormal Return") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face = "bold"),
legend.title = element_blank())
knitr::opts_chunk$set(echo = TRUE)
install.packages("twitteR")
knitr::opts_chunk$set(echo = TRUE)
install.packages("tidytext")
dat<- data.frame(t=seq(0, 2*pi, by=0.1) )
xhrt <- function(t) 16*sin(t)^3
yhrt <- function(t) 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)
dat$y=yhrt(dat$t)
dat$x=xhrt(dat$t)
with(dat, plot(x,y, type="l"))
with(dat, polygon(x,y, col="red"))
dat<- data.frame(t=seq(0, 2*pi, by=0.1) )
xhrt <- function(t) 16*sin(t)^3
yhrt <- function(t) 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)
dat$y=yhrt(dat$t)
dat$x=xhrt(dat$t)
with(dat, plot(x,y, type="l"))
with(dat, polygon(x,y, col="red"))
dat<- data.frame(t=seq(0, 2*pi, by=0.1))
xhrt <- function(t) 16*sin(t)^3
yhrt <- function(t) 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)
dat$y=yhrt(dat$t)
dat$x=xhrt(dat$t)
with(dat, plot(x,y, type="l"))
with(dat, polygon(x,y, col="red"))
dat<- data.frame(t=seq(0, 2*pi, by=0.1))
xhrt <- function(t) 16*sin(t)^3
yhrt <- function(t) 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)
dat$y=yhrt(dat$t)
dat$x=xhrt(dat$t)
with(dat, plot(x,y, type="l"))
with(dat, polygon(x,y, col="red"))
install.packages("Cairo")
library(Cairo)
dat<- data.frame(t=seq(0, 2*pi, by=0.1))
xhrt <- function(t) 16*sin(t)^3
yhrt <- function(t) 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)
dat$y=yhrt(dat$t)
dat$x=xhrt(dat$t)
with(dat, plot(x,y, type="l"))
with(dat, polygon(x,y, col="red"))
library(Cairo)
clubs <- expression(symbol('\247'))
hearts <- expression(symbol('\251'))
diamonds <- expression(symbol('\250'))
spades <- expression(symbol('\252'))
csymbols <- c(clubs, hearts, diamonds, spades)
plot( 0, xlim=c(0,5), ylim=c(0,2), type="n" )
clr <- c("black", "red", "red", "black")
for (i in 1:4) {
hline <- function( yloc, ... )
for (i in 1:length(yloc))
lines( c(-1,6), c(yloc[i],yloc[i]), col="gray")
hline(0.9);
hline(1.0);
hline(1.1);
hline(1.2)
text( i, 1, csymbols[i], col=clr[i], cex=5 )
text( i, 0.5, csymbols[i], col=clr[i] ) }
# Also try this
plot(1,1)
text(x=1+0.2*cos(seq(0, 2*pi, by=.5)),
y=1+0.2*sin(seq(0, 2*pi, by=.5)),
expression(symbol('\251') ) )
knitr::opts_chunk$set(echo = TRUE)
# Source: http://statistics.berkeley.edu/classes/s133/heart.r
heart1 = function(name){
t = seq(0,60,len=100)
plot(c(-8,8),c(0,20),type='n',axes=FALSE,xlab='',ylab='')
x = -.01*(-t^2+40*t+1200)*sin(pi*t/180)
y = .01*(-t^2+40*t+1200)*cos(pi*t/180)
lines(x,y, lwd=4)
lines(-x,y, lwd=4)
text(0,7,"Happy Valentine's Day",col='red',cex=2.5)
text(0,5.5,name,col='red',cex=2.5)
}
require(ggplot2)
dat <- data.frame(t = seq(0, 2*pi, by = 0.01))
x <-  function(t) 16 * sin(t)^3
y <- function(t) 13*cos(t) - 5*cos(2*t) - 2*cos(3*t) - cos(4*t)
dat$y <- y(dat$t)
dat$x <- x(dat$t)
heart <- ggplot(dat, aes(x,y)) +
geom_polygon(fill = "red", col = "firebrick", alpha = 0.9) +
theme_classic()
heart
knitr::opts_chunk$set(echo = TRUE)
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
library(readxl)
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
View(syndicated_loan)
View(syndicated_loan)
View(syndicated_loan)
library(readxl)
library(readxl)
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
View(syndicated_loan)
View(syndicated_loan)
View(syndicated_loan)
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="orange") +
ggtitle("Getiri Oranları")
library(ggplot2)
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="orange") +
ggtitle("Getiri Oranları")
geom_line(color="80d7cc) +
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="80d7cc") +
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="80d7cc") +
ggtitle("Syndication Loan Increase in Turkey")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="#80d7cc") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "italic", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Syndication Loan Increase in Turkey")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="red") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "italic", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Syndication Loan Increase in Turkey")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="blue") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "italic", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Syndication Loan Increase in Turkey")
library(readxl)
library(ggplot2)
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="blue") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "italic", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Syndication Loan Increase in Turkey")
library(readxl)
library(ggplot2)
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="blue") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "italic", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Syndication Loan Increase in Turkey")
library(readxl)
library(ggplot2)
syndicated_loan <- read_excel("C:/Users/İrem/Desktop/syndicated_loan.xlsx")
ggplot(syndicated_loan, aes(x=Date, y=in_foreign_currency_according_to_TL)) +
geom_line(color="blue") +
theme_minimal() +
theme(axis.title = element_blank(),
plot.title = element_text(face = "italic", hjust = 0.5)) +
geom_hline(yintercept = 0) +
ggtitle("Syndication Loan Increase in Turkey")
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
options(scipen = 999)
library(tidyverse)
library(readxl)
library(PerformanceAnalytics)
library(kableExtra)
#importing the data
hist_price <- read_excel("C:/Users/İrem/Desktop/port_2/historical.xlsx")
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
options(scipen = 999)
library(tidyverse)
library(readxl)
library(PerformanceAnalytics)
library(kableExtra)
#importing the data
hist_price <- read_excel("C:/Users/İrem/Desktop/port_2/historical.xlsx")
distill::create_post(title = "ff93-en")
