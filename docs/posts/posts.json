[
  {
    "path": "posts/2022-05-16-portfolio-selection-en/",
    "title": "Optimum Portfolio Selection",
    "description": "We are gonna create the best portfolio with 10 stocks selected from BIST.",
    "author": [
      {
        "name": "Irem Dastan",
        "url": {}
      }
    ],
    "date": "2022-05-16",
    "categories": [
      "Finance",
      "Portfolio Selection"
    ],
    "contents": "\r\n\r\n\r\nlibrary(readxl);library(tidyverse);library(openxlsx);\r\nlibrary(data.table);library(mice);library(knitr);library(kableExtra);\r\nlibrary(quantmod);library(TTR);library(readxl);library(timeSeries);\r\nlibrary(fPortfolio);library(tseries);library(PerformanceAnalytics)\r\n\r\n\r\n\r\nIn a portfolio, it is necessary to consider the risk as well as the\r\nreturn. The risk of a high-yielding asset can be very high, and if you\r\ndid not make the right choice, you are very likely to lose. For example,\r\nlet’s say an asset X has a return of 2.5% and a variance of 4%. On the\r\nother hand, an asset Y has the same risk, but its return is 3.5%. How\r\ndoes ? Let’s see in the graph below.\r\n\r\n\r\nknitr::include_graphics(\"img1.jpg\")\r\n\r\n\r\n\r\n\r\nIf we compare the points A’, B’ and C’ with the points A, B, C on the\r\ngraph; We see that A and A’ have the same risk, but A’s provides a\r\nhigher return. The same is true for other points.\r\n! The investor must be desire to act according to efficient\r\nfrontier.\r\nFor more detailed information on the subject, you can read the paper by\r\nMarkowitz, H. (1952).\r\nLet’s apply this to stocks.\r\nFirstly, I selected 10 stocks between 31 December 2019 and 30\r\nDecember 2021. The stocks I chose are as follows;\r\nAKBNK, SAHOL, TUPRS, THYAO, KCHOL, SISE, TAVHL, TCELL, HALKB,\r\nTTKOM\r\nImporting the data\r\n\r\n\r\ndata <- read_excel(\"data.xlsx\") # You can access the data on my GitHub.\r\ndata <- na.omit(data) \r\n\r\n#I'm checking to see if there are any missing observations.\r\nmd.pattern(data)\r\n\r\n\r\n /\\     /\\\r\n{  `---'  }\r\n{  O   O  }\r\n==>  V <==  No need for mice. This data set is completely observed.\r\n \\  \\|/  /\r\n  `-----'\r\n\r\n     Ticker Date Close  \r\n5010      1    1     1 0\r\n          0    0     0 0\r\n\r\nCalculating the Returns\r\n\r\n\r\ndata <- data %>% \r\n  arrange(Ticker) %>%\r\n  group_by(Ticker) %>%\r\n  mutate(lagClose=shift(Close, 1, type= \"lag\"),\r\n         perReturn= (Close-lagClose)/lagClose,\r\n         logReturn= log(Close/lagClose)) %>%\r\n ungroup()\r\n\r\nggplot(data, aes(x=Date, y=perReturn, group= Ticker)) +\r\n  geom_line(color=\"#80d7cc\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n  plot.title = element_text(face = \"italic\", hjust = 0.5)) +\r\n  geom_hline(yintercept = 0) +\r\n  ggtitle(\"Per Return\")\r\n\r\n\r\n\r\n\r\nSummary Statistics\r\n\r\n\r\n#Transpose\r\nt_data <- data %>%\r\n  select(Ticker,Date,perReturn) %>% \r\n  pivot_wider(names_from = \"Ticker\", values_from = \"perReturn\") %>% \r\n  slice(-1)\r\n\r\ndat <- t_data %>% \r\n  column_to_rownames(var = \"Date\")\r\n\r\ndat_cor <- dat %>% \r\n  cor()\r\n\r\n\r\n\r\nThere must be a negative relationship between the correlations.\r\nBecause the investor has to pass the loss from one stock to the profit\r\nfrom the other. If the correlation is zero (0), it means that there is\r\nno relationship between them.\r\n\r\n\r\ndat_vcov <- dat %>% \r\n  cov(dat) %>% \r\n  as.data.frame() %>% \r\n  mutate_all(.funs = function(x) round(x, digits = 4))\r\n\r\ndat_summary <- dat %>% \r\n  pivot_longer(everything()) %>% \r\n  arrange(name) %>% \r\n  group_by(name) %>%\r\n  summarise_at(vars(value), list(Min = min, Mean = mean, Max = max, Sd = sd))\r\n\r\n\r\n# For Turkey Risk Free rate (Rf): 17,7%\r\nrf <- 0.17/250  # Daily risk free rate \r\n\r\ndat_summary <- dat_summary %>% \r\n  mutate(\r\n    Sharpe = (Mean - rf) / Sd\r\n  ) %>% \r\n  arrange(Sharpe)\r\n\r\nggplot(dat_summary, aes(x= Sd, y= Mean, color = name, size = Sharpe)) +\r\n  geom_point(alpha = .5) + \r\n  ggrepel::geom_text_repel(aes(label = paste0(name,\" (\",round(Sharpe, digits = 3),\")\"))) +\r\n  theme_minimal() +\r\n  theme(legend.position = \"none\") +\r\n  labs(x = \"Risk\", y = \"Expected Return\") \r\n\r\n\r\n\r\n\r\nThe size of the points here is according to the sharpe ratio.\r\nA high Sharpe ratio means that the portfolio created is resistant to\r\nrisks, and a low one means that the portfolio created is open to risks.\r\nAmong the 10 stocks I chose, HALKB is the most open to risk.\r\nKCHOL and THYAO have relatively close risks to each other. TCELL has\r\nsimilar risks in SAHOL and TTKOM. SISE is the most risk-resistant stock\r\nwith the highest ratio. If we choose the best 2 stocks;\r\n1st SISE\r\n2nd. It is THYAO\r\nLet’s\r\ncreate two stock portfolios and choose a portfolio among them.\r\n\r\n\r\nsharpe <- NULL\r\nstock1 <- NULL\r\nstock2 <- NULL\r\nweights <- seq(0.1,0.9,0.1)\r\n\r\nfor (j in 1:length(colnames(dat))) { \r\n  for (i in 1:length(colnames(dat))) { \r\n    \r\n    if(i != j) {\r\n      x <- dat[,j] \r\n      y <- dat[,i] \r\n      \r\n      for (w.x in weights) { \r\n        \r\n        w.y <- 1 - w.x\r\n        \r\n        p_Return <- mean(x) * w.x + mean(y) * w.y\r\n        p_Risk <- (var(x) * w.x^2 + var(y) * w.y^2 + 2 * w.x * w.y * cov(x,y))^0.5\r\n        \r\n        temp.sharp <- (p_Return - rf) /  p_Risk\r\n        \r\n        sharpe <- c(sharpe, temp.sharp)\r\n        stock1 <- c(stock1, colnames(dat)[j])\r\n        stock2 <- c(stock2, colnames(dat)[i])\r\n        \r\n        rm(temp.sharp, p_Return, p_Risk, w.stock2)\r\n      }\r\n      rm(x,y)\r\n    }\r\n  }\r\n}\r\n\r\n\r\nweight_1 <- rep(weights,length(sharpe)/length(weights))\r\nsharpe.result <- data.frame(cbind(stock1,weight_1,stock2,sharpe))\r\nsharpe.result$sharpe <- as.numeric(as.character(sharpe.result$sharpe))\r\n\r\nsharpe.result <- sharpe.result[order(sharpe.result$sharpe, decreasing = TRUE),]\r\n\r\n\r\n# We've added a Risk and Return column below.\r\nsharpe.result$Return <- NA\r\nsharpe.result$Risk <- NA\r\n\r\nfor(i in 1:nrow(sharpe.result)){\r\n  \r\n  stock_1 <- sharpe.result[i,1]\r\n  stock_2 <- sharpe.result[i,3]\r\n  \r\n  stock_1_ret <- dat[[stock_1]]\r\n  stock_2_ret <- dat[[stock_2]]\r\n\r\n  stock_1_w <- as.numeric(sharpe.result[i,2])\r\n  stock_2_w <- 1 - stock_1_w\r\n\r\n  sharpe.result$Return[i] <- mean(stock_1_ret) * stock_1_w + mean(stock_2_ret) * stock_2_w\r\n  \r\n  sharpe.result$Risk[i] <- (var(stock_1_ret) * stock_1_w^2 + var(stock_2_ret) * stock_2_w^2 + 2 * \r\n                              stock_1_w * stock_2_w * cov(stock_1_ret,stock_2_ret))^0.5\r\n}\r\n\r\n\r\nnew_plot_df <- sharpe.result %>% \r\n  select(Return,Risk) %>% \r\n  bind_rows(\r\n    data.frame(\r\n      Return = dat_summary$Mean,\r\n      Risk = dat_summary$Sd\r\n    )\r\n  ) %>% \r\n  mutate(\r\n    colgr = c(rep(\"2 Stocks Portfolios\",810),rep(\"Single Stock Portfolio\",10))\r\n  )\r\n\r\n\r\n\r\nLet’s\r\nshow it in a risk-return graph where we compare portfolios of two stocks\r\nand portfolios of single stocks.\r\n\r\n\r\nggplot(new_plot_df, aes(x = Risk, y = Return, color = colgr)) +\r\n  geom_point() +\r\n  theme_minimal() +\r\n  theme(legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"italic\", hjust = 0.5)) +\r\n  labs(x = \"Risk\", y = \"Expected Return\") +\r\n  scale_color_manual(values = c(\"gray\",\"red\")) +\r\n  labs(title = \"Two Stocks Portfolios vs Single Stock Portfolio\") \r\n\r\n\r\n\r\n\r\nLet’s determine the\r\noptimal portfolio with:\r\n10 assets\r\n\\(W_{i} ≥ 0\\)\r\n\r\n\r\nstock10 <- data.frame(\r\n  matrix(data = \"\", nrow = 1, ncol = 10)\r\n) %>% \r\n  `colnames<-`(names(dat))\r\n\r\nfor(i in 1:100){  #Here, we weighed it 100 times differently.\r\n  \r\n  rnd <- wakefield::probs(10)\r\n  \r\n  for(j in 1:ncol(stock10)){\r\n    \r\n    stock10[i,j] <- rnd[j]\r\n    \r\n  }\r\n  \r\n}\r\n\r\nstock10 <- stock10 %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  mutate_all(function(x) round(x, digits = 2)) %>% \r\n  distinct() %>% \r\n  mutate(ExpectedReturn = \"\",\r\n         Risk = \"\",\r\n         SharpeRatio = \"\")\r\n\r\nfor(k in 1:nrow(stock10)){\r\n  \r\n  portfolio_daily_returns <- Return.portfolio(dat, weights = as.numeric(stock10[k,c(1:10)]))\r\n  expectedReturn <- mean(portfolio_daily_returns$portfolio.returns)\r\n  risk <- sd(portfolio_daily_returns$portfolio.returns)\r\n  \r\n  sharpe_ratio <- round(\r\n  SharpeRatio(portfolio_daily_returns, Rf = 0.177/250), 4\r\n) %>% \r\n    .[[1]]\r\n  \r\n  stock10[k,11] <- expectedReturn\r\n  stock10[k,12] <- risk\r\n  stock10[k,13] <- sharpe_ratio\r\n  \r\n}\r\n\r\nstock10 <- stock10 %>% \r\n  mutate_if(is.character,as.numeric) %>% \r\n  mutate(MaxReturnPortfolio = ifelse(ExpectedReturn == max(ExpectedReturn),\"MaxReturn\",\"Others\"))\r\n\r\nggplot(stock10, aes(x = Risk, y = ExpectedReturn, color = MaxReturnPortfolio)) +\r\n  geom_point() +\r\n  theme_minimal() +\r\n  theme(legend.title = element_blank()) +\r\n  scale_color_manual(values = c(\"red\",\"gray\"))\r\n\r\n\r\n\r\nmyPortfolio <- stock10 %>% \r\n  dplyr::filter(MaxReturnPortfolio == \"MaxReturn\")\r\n\r\n\r\n\r\nThe red dot here is the best portfolio.\r\n\r\n\r\nmyPortfolio %>% \r\n  select(1:10) %>% \r\n  kbl() %>% \r\n  kable_styling()\r\n\r\n\r\n\r\nAKBNK\r\n\r\n\r\nHALKB\r\n\r\n\r\nKCHOL\r\n\r\n\r\nSAHOL\r\n\r\n\r\nSISE\r\n\r\n\r\nTAVHL\r\n\r\n\r\nTCELL\r\n\r\n\r\nTHYAO\r\n\r\n\r\nTTKOM\r\n\r\n\r\nTUPRS\r\n\r\n\r\n0.01\r\n\r\n\r\n0\r\n\r\n\r\n0.18\r\n\r\n\r\n0.2\r\n\r\n\r\n0.21\r\n\r\n\r\n0.02\r\n\r\n\r\n0.12\r\n\r\n\r\n0.03\r\n\r\n\r\n0.14\r\n\r\n\r\n0.08\r\n\r\n\r\nmyPortfolio %>% \r\n  select(11:13) %>% \r\n  kbl() %>% \r\n  kable_styling()\r\n\r\n\r\n\r\nExpectedReturn\r\n\r\n\r\nRisk\r\n\r\n\r\nSharpeRatio\r\n\r\n\r\n0.0011548\r\n\r\n\r\n0.018506\r\n\r\n\r\n0.0241\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-05-16-portfolio-selection-en/img1.jpg",
    "last_modified": "2022-05-16T22:42:44+03:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-05-08-hft-en/",
    "title": "Investigating High-Frequency Trading (HFT) Around the Extreme Price Movements in Borsa Istanbul",
    "description": "In this study, I analyzed the existence of high-frequency trading (HFT) in Borsa Istanbul. My focus is it's the behavior and market share of high-frequency trading during extreme price movements (EPM).",
    "author": [
      {
        "name": "Irem Dastan",
        "url": {}
      }
    ],
    "date": "2022-05-08",
    "categories": [
      "Finance",
      "Market Microstructure"
    ],
    "contents": "\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(knitr)\r\nlibrary(kableExtra)\r\nlibrary(ggalt)\r\nlibrary(lubridate)\r\nlibrary(stargazer)\r\nlibrary(fastDummies)\r\n\r\ndata <- read.csv(\"data.csv\") #You can access the data on Github.\r\nnames(data)[1] <- \"stock\" \r\n\r\n\r\n\r\nIn this study, I analyzed the existence of high-frequency trading\r\n(HFT) in Borsa Istanbul. My focus is it’s the behavior and market share\r\nof high-frequency trading during extreme price movements (EPM).\r\nFully automated exchanges have increased the number of transactions\r\nin the market and enabled intermediaries to expand their use of\r\ntechnology. Trading behind software based on the ability to process and\r\nreact quickly to the trading flow of data, to the flow of market\r\ninformation has made it possible to carry out a large number of trading\r\nin a short time. However, there are still problems with speed in\r\nfinancial markets, using data to invest or to enter trades quickly. For\r\nthis reason, there is a speed race in which the fastest actors compete\r\nwith each other in financial markets. Thus, the markets are now\r\ndominated by computer algorithms, not by buying and selling tradings\r\nmade by humans.\r\nHFT; It is a type of trading that can be defined with thousands of\r\norder submissions, high order cancellations and intraday marginal profit\r\ntarget, keeping positions in seconds or milliseconds in fractions of a\r\nsecond. Briefly; “HFT leverages the technological capability of sending\r\nlarge numbers of orders at low millisecond delays” (Ersan and Ekinci,\r\n2016).\r\nAs HFT algorithms compete with each other, they face two\r\nchallenges:\r\nThey receive large amounts of data every microsecond.\r\nThey must be able to act very quickly on the observed data,\r\nbecause the profitability of the signals they observe decreases very\r\nquickly.\r\nThe dominant role played by HFT firms in providing liquidity and\r\nprice arbitrage in the market directly affects the market share of\r\ntrading areas. Its participation in arbitrages is obtained from the\r\nprice differences of the shares traded in more than one market, by\r\nmaking profit from small price differences with short-term trading and\r\nhigh volumes.\r\nBISTECH platform, which was put into use in the Equity Market on\r\nNovember 30, 2015, allowed the inclusion of HFT. HFT share in Borsa\r\nIstanbul is not as developed as the USA and European countries.\r\nThe difference between HFT and AT (Algorithmic Trading); AT is more\r\ncomprehensive and HFT is a subset of AT. AT is a structure that provides\r\ntrading with conditions defined in the computer environment, while HFT\r\nevaluates the opportunities that occur in very small seconds. In short,\r\nHFT is a variant of AT.\r\n\r\n\r\n\r\nStocks listed in BIST30 index.\r\n\r\n\r\n\r\n16-month period from December 2015 to March 2017, 339 trading\r\ndays.\r\n\r\n\r\n\r\nObtaining the daily versions of the variables obtained from the\r\nintraday order-trading books from the study of Ekinci and Ersan\r\n(2020).\r\nVariables in the study; HFT total, HFT trading sides, HFT trading\r\ndifference (HFT imbalance). Control variables; trading volume, liquidity\r\nand volatility. The dummy variables, which are the main independent\r\nvariables, are; extreme positive price movements (shares and days with\r\nreturns of 2% and more than 5%), and extreme negative price movements\r\n(stocks and days with returns below -2% and -5%).\r\nI analyze in three stages.\r\nBased on stock and return range\r\nT-test\r\nRegression analysis\r\nCalculating the HFT\r\nFirst of all, some orders are marked as HFT orders in the data. We do\r\nthis in two stages.\r\nFirst, orders with at least two messages (order submission,\r\nchange, cancellation) in 1 second or less.\r\nLatter, we determine it as any message of the HFT orders\r\ndetermined in the 1st stage, as other orders of the same stock that come\r\nin the same second and in the same size.\r\n\\(HFT\\ ratio_{i,t}=\\frac{Electronic\\\r\nmessage_{i,t}^{HFT}}{Electronic\\ message_{all^{HFT}}}\\)\r\n\\(Liquidity_{i,t}= \\sum_{j=1}^{N}\r\nVolume_{i,j,t}*(\\frac{Duration_{i,j,t}}{Duration_{total}})\\)\r\nAnalyzes\r\nStatistics of\r\nVariables in Daily Return Ranges\r\n\r\n\r\ntable1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n      return > -0.02 & return <= 0.02 ~ \"between -2% and 2%\",\r\n      return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_volatility = mean(volatility),\r\n    sd_volatility = sd(volatility),\r\n    avg_liquidity = mean(liquidity),\r\n    sd_liquidity = sd(liquidity),\r\n    avg_hft_buy = mean(hft_buy),\r\n    sd_hft_buy = sd(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    sd_hft_sell = sd(hft_sell),\r\n    avg_hft = mean(hft),\r\n    sd_hft = sd(hft),\r\n    avg_return = mean(return),\r\n    sd_return = sd(return),\r\n    avg_bist30_return = mean(bist30_return),\r\n    sd_bist30_return = sd(bist30_return),\r\n    avg_extra_ret_market = mean(extra_ret_market),\r\n    sd_extra_ret_market = sd(extra_ret_market),\r\n    avg_volume = mean(volume),\r\n    sd_volume = sd(volume)\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  mutate_at(vars(-c(return_type, avg_liquidity, sd_liquidity, avg_volume, sd_volume)),\r\n            .funs = function(x) round(x, digits = 4)) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1)\r\n\r\nkable(table1) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_volatility\r\n\r\n\r\n0.0829\r\n\r\n\r\n0.0391\r\n\r\n\r\n0.0218\r\n\r\n\r\n0.0350\r\n\r\n\r\n0.0765\r\n\r\n\r\nsd_volatility\r\n\r\n\r\n0.0416\r\n\r\n\r\n0.0135\r\n\r\n\r\n0.0107\r\n\r\n\r\n0.0141\r\n\r\n\r\n0.0320\r\n\r\n\r\navg_liquidity\r\n\r\n\r\n41445971\r\n\r\n\r\n30858481\r\n\r\n\r\n27199639\r\n\r\n\r\n29163226\r\n\r\n\r\n30176844\r\n\r\n\r\nsd_liquidity\r\n\r\n\r\n61709828\r\n\r\n\r\n48518623\r\n\r\n\r\n36877463\r\n\r\n\r\n34473672\r\n\r\n\r\n35416041\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n0.0336\r\n\r\n\r\n0.0454\r\n\r\n\r\n0.0551\r\n\r\n\r\n0.0547\r\n\r\n\r\n0.0518\r\n\r\n\r\nsd_hft_buy\r\n\r\n\r\n0.0354\r\n\r\n\r\n0.0548\r\n\r\n\r\n0.0625\r\n\r\n\r\n0.0583\r\n\r\n\r\n0.0525\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0653\r\n\r\n\r\n0.0566\r\n\r\n\r\n0.0603\r\n\r\n\r\n0.0476\r\n\r\n\r\n0.0401\r\n\r\n\r\nsd_hft_sell\r\n\r\n\r\n0.0608\r\n\r\n\r\n0.0600\r\n\r\n\r\n0.0680\r\n\r\n\r\n0.0537\r\n\r\n\r\n0.0456\r\n\r\n\r\navg_hft\r\n\r\n\r\n0.0501\r\n\r\n\r\n0.0531\r\n\r\n\r\n0.0605\r\n\r\n\r\n0.0535\r\n\r\n\r\n0.0487\r\n\r\n\r\nsd_hft\r\n\r\n\r\n0.0415\r\n\r\n\r\n0.0510\r\n\r\n\r\n0.0592\r\n\r\n\r\n0.0506\r\n\r\n\r\n0.0443\r\n\r\n\r\navg_return\r\n\r\n\r\n-0.0700\r\n\r\n\r\n-0.0288\r\n\r\n\r\n-0.0001\r\n\r\n\r\n0.0292\r\n\r\n\r\n0.0710\r\n\r\n\r\nsd_return\r\n\r\n\r\n0.0236\r\n\r\n\r\n0.0073\r\n\r\n\r\n0.0101\r\n\r\n\r\n0.0074\r\n\r\n\r\n0.0283\r\n\r\n\r\navg_bist30_return\r\n\r\n\r\n-0.0278\r\n\r\n\r\n-0.0132\r\n\r\n\r\n0.0007\r\n\r\n\r\n0.0122\r\n\r\n\r\n0.0156\r\n\r\n\r\nsd_bist30_return\r\n\r\n\r\n0.0231\r\n\r\n\r\n0.0130\r\n\r\n\r\n0.0097\r\n\r\n\r\n0.0124\r\n\r\n\r\n0.0157\r\n\r\n\r\navg_extra_ret_market\r\n\r\n\r\n-0.0423\r\n\r\n\r\n-0.0156\r\n\r\n\r\n-0.0007\r\n\r\n\r\n0.0170\r\n\r\n\r\n0.0554\r\n\r\n\r\nsd_extra_ret_market\r\n\r\n\r\n0.0270\r\n\r\n\r\n0.0125\r\n\r\n\r\n0.0100\r\n\r\n\r\n0.0131\r\n\r\n\r\n0.0352\r\n\r\n\r\navg_volume\r\n\r\n\r\n33566193\r\n\r\n\r\n21242601\r\n\r\n\r\n14819716\r\n\r\n\r\n20296933\r\n\r\n\r\n31332308\r\n\r\n\r\nsd_volume\r\n\r\n\r\n51693115\r\n\r\n\r\n32522232\r\n\r\n\r\n23687389\r\n\r\n\r\n27891523\r\n\r\n\r\n45142746\r\n\r\n\r\nConsidering the liquidity, the average and standard deviation\r\nbelow -5% belong to non-return stocks and days. The average market\r\nvolume was experienced most intensely on non-return days.\r\nNumber\r\nof Days Above 2% and Below -2% of Returns on a Stock Basis\r\n\r\n\r\ngraph1_1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit() %>% \r\n  pivot_wider(names_from = \"return_type\", values_from = \"number_of_days\")\r\n\r\ngraph1_2 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit()\r\n\r\nggplot(graph1_1, aes(y = stock)) + \r\n  geom_point(data = graph1_2,\r\n             aes(x = number_of_days, color = return_type), size = 3) +\r\n  scale_color_manual(values = c(\"orange\",\"#76a5af\")) +\r\n  geom_dumbbell(aes(x = `below -2%`, xend = `above 2%`),\r\n                size_x = 5, \r\n                size_xend = 5,\r\n                colour_x = \"#76a5af\",\r\n                colour_xend = \"orange\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n        legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"bold\", hjust = 0.5),\r\n        axis.text = element_text(size = 12, face = \"bold\")) +\r\n  guides(color = guide_legend(reverse=T)) +\r\n  labs(title = \"The Number of Days of Returns\")\r\n\r\n\r\n\r\n\r\nThe stock with the highest number of days with a return of more\r\nthan 5% is KOZAL, and the stocks with the least number of days; ENKAI,\r\nKCHOL, PETKM, SAHOL, TTKOM and TUPRS.\r\nNumber\r\nof Days Above 5% and Under -5% of Returns on a Stock Basis\r\n\r\n\r\ngraph2_1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit() %>% \r\n  pivot_wider(names_from = \"return_type\", values_from = \"number_of_days\")\r\n\r\ngraph2_2 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit()\r\n\r\nggplot(graph2_1, aes(y = stock)) + \r\n  geom_point(data = graph2_2,\r\n             aes(x = number_of_days, color = return_type), size = 3) +\r\n  scale_color_manual(values = c(\"#80dead\",\"#f1cbff\")) +\r\n  geom_dumbbell(aes(x = `below -5%`, xend = `above 5%`),\r\n                size_x = 5, \r\n                size_xend = 5,\r\n                colour_x = \"#f1cbff\",\r\n                colour_xend = \"#80dead\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n        legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"bold\", hjust = 0.5),\r\n        axis.text = element_text(size = 12, face = \"bold\")) +\r\n  guides(color = guide_legend(reverse=T)) +\r\n  labs(title = \"The Number of Days of Returns\")\r\n\r\n\r\n\r\n\r\nHere, we determined the HFTs within the return limits we chose\r\nthroughout our data and averaged them on a share basis. The stock with\r\nthe highest return under -5% HFT average is TTKOM.\r\nMonthly\r\nAverage HFT Rate and Extreme Price Moving Days and Number of Stocks\r\n\r\n\r\ngraph3 <- data %>%\r\n  select(day, return, hft) %>% \r\n  mutate(day = dmy(day), \r\n         month = month(day),\r\n         year = year(day),\r\n         return_type=case_when(\r\n           return < -0.02 ~ \"below -2%\",\r\n           return > 0.02 ~ \"above 2%\"\r\n    )) %>% \r\n  na.omit() %>% \r\n  group_by(month, year) %>% \r\n  summarise(\"Extreme Price Movements\" = n(),\r\n            \"High Frequency Trading\" = mean(hft)) %>% \r\n  mutate(day = as.Date(paste0(year, \"-\", month, \"-\", 1))) %>% \r\n  arrange(day) %>% \r\n  ungroup() %>% \r\n  select(day, `Extreme Price Movements`, `High Frequency Trading`) %>% \r\n  pivot_longer(!day, names_to = \"types\", values_to = \"value\")\r\n\r\nggplot(graph3, aes(x = day, y = value, group = types, color = types)) +\r\n  geom_line() +\r\n  theme_minimal() + \r\n  theme(axis.title = element_blank(), \r\n        legend.position = \"none\") +\r\n  facet_wrap(~types, scales = \"free_y\", ncol = 1)\r\n\r\n\r\n\r\n\r\nIn the graph, we see the relationship of EPM with values on the\r\nleft and HFT with ratios on the right. Our tipping rate in EPM is minus\r\nand plus 2%. The EPM values are the sum of the days within these two\r\nextreme prices in the return. HFT rates are obtained by dividing the sum\r\nof HFTs on a monthly basis by the number of days in that month. It is\r\nseen that the number of EPM days is decreasing and the HFT ratio is\r\nincreasing. The period with the least extreme price movement; October\r\n2016, the highest is December 2015. The HFT rate reached its highest\r\nlevel in March 2017.\r\nHFT Activity in Daily\r\nReturn Ranges\r\n\r\n\r\ntable2 <- data %>% \r\n  select(hft, hft_buy, hft_sell, return) %>% \r\n  mutate(hft_buy_sell_diff = hft_buy - hft_sell,\r\n         hft_inequilibrium = (hft_buy - hft_sell)/hft, \r\n         return_type=case_when(\r\n           return <= -0.05 ~ \"below -5%\",\r\n           return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n           return > -0.02 & return <= -0.005 ~ \"between -2% and -0.5%\",\r\n           return > -0.005 & return <= 0.005 ~ \"between -0.5% and 0.5%\",\r\n           return > 0.005 & return <= 0.02 ~ \"between 0.5% and 2%\",\r\n           return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n           return > 0.05 ~ \"above 5%\"\r\n    )) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_hft = mean(hft),\r\n    avg_hft_buy = mean(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    avg_hft_buy_sell_diff = mean(hft_buy_sell_diff),\r\n    avg_hft_inequilibrium = mean(hft_inequilibrium, na.rm = T)\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and -0.5%\",\r\n                              \"between -0.5% and 0.5%\",\r\n                              \"between 0.5% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  mutate_at(vars(-c(return_type)), .funs = function(x) round(x, digits = 4)) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1)\r\n\r\nkable(table2) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and -0.5%\r\n\r\n\r\nbetween -0.5% and 0.5%\r\n\r\n\r\nbetween 0.5% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_hft\r\n\r\n\r\n0.0501\r\n\r\n\r\n0.0531\r\n\r\n\r\n0.0596\r\n\r\n\r\n0.0609\r\n\r\n\r\n0.0610\r\n\r\n\r\n0.0535\r\n\r\n\r\n0.0487\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n0.0336\r\n\r\n\r\n0.0454\r\n\r\n\r\n0.0495\r\n\r\n\r\n0.0557\r\n\r\n\r\n0.0602\r\n\r\n\r\n0.0547\r\n\r\n\r\n0.0518\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0653\r\n\r\n\r\n0.0566\r\n\r\n\r\n0.0641\r\n\r\n\r\n0.0603\r\n\r\n\r\n0.0563\r\n\r\n\r\n0.0476\r\n\r\n\r\n0.0401\r\n\r\n\r\navg_hft_buy_sell_diff\r\n\r\n\r\n-0.0317\r\n\r\n\r\n-0.0112\r\n\r\n\r\n-0.0146\r\n\r\n\r\n-0.0046\r\n\r\n\r\n0.0039\r\n\r\n\r\n0.0071\r\n\r\n\r\n0.0117\r\n\r\n\r\navg_hft_inequilibrium\r\n\r\n\r\n-0.6879\r\n\r\n\r\n-0.2948\r\n\r\n\r\n-0.2616\r\n\r\n\r\n-0.0664\r\n\r\n\r\n0.0768\r\n\r\n\r\n0.1529\r\n\r\n\r\n0.2846\r\n\r\n\r\nIn the table, there are the averages of the HFT variables of the\r\ndays that fall into different return ranges. When approaching from minus\r\n5% to zero, the HFT and HFT purchase values decrease and grow after\r\nzero. In the averages of the HFT buying and selling difference, while it\r\napproaches zero, it shrinks and in the case of positive EPMs, the\r\naverages increase. In the average of the ratio of the HFT difference to\r\nthe HFT, this average value grows as the stocks and days with an EPM\r\nbelow -5% get closer to the stocks and days with a positive\r\nEPM.\r\nHFT\r\nActivity on Extreme Price Moving Days and Stocks\r\n\r\n\r\ntable3 <- data %>% \r\n   select(hft, hft_buy, hft_sell, return) %>% \r\n  mutate(hft_buy_sell_diff = hft_buy - hft_sell,\r\n         hft_inequilibrium = (hft_buy - hft_sell)/hft, \r\n         return_type=case_when(\r\n           return <= -0.05 ~ \"below -5%\",\r\n           return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n           return > -0.02 & return <= -0.005 ~ \"between -2% and -0.5%\",\r\n           return > -0.005 & return <= 0.005 ~ \"between -0.5% and 0.5%\",\r\n           return > 0.005 & return <= 0.02 ~ \"between 0.5% and 2%\",\r\n           return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n           return > 0.05 ~ \"above 5%\"\r\n    )) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_hft = mean(hft),\r\n    avg_hft_buy = mean(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    avg_hft_buy_sell_diff = mean(hft_buy_sell_diff),\r\n    avg_hft_inequilibrium = mean(hft_inequilibrium, na.rm = T),\r\n    p_hft = t.test(hft)$p.value,\r\n    p_hft_buy = t.test(hft_buy)$p.value,\r\n    p_hft_sell = t.test(hft_sell)$p.value,\r\n    p_hft_buy_sell_diff = t.test(hft_buy_sell_diff)$p.value,\r\n    p_hft_inequilibrium = t.test(hft_inequilibrium)$p.value\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and -0.5%\",\r\n                              \"between -0.5% and 0.5%\",\r\n                              \"between 0.5% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  select(return_type, avg_hft, p_hft, avg_hft_buy, p_hft_buy, avg_hft_sell,\r\n         p_hft_sell, avg_hft_buy_sell_diff, p_hft_buy_sell_diff, avg_hft_inequilibrium, p_hft_inequilibrium) %>% \r\n  mutate_at(vars(-c(return_type)), .funs = function(x) round(x, digits = 4)) %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1) %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  mutate_all(.funs = function(x) x - .[,4])\r\n  \r\nkable(table3) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and -0.5%\r\n\r\n\r\nbetween -0.5% and 0.5%\r\n\r\n\r\nbetween 0.5% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_hft\r\n\r\n\r\n-0.0108\r\n\r\n\r\n-0.0078\r\n\r\n\r\n-0.0013\r\n\r\n\r\n0\r\n\r\n\r\n0.0001\r\n\r\n\r\n-0.0074\r\n\r\n\r\n-0.0122\r\n\r\n\r\np_hft\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n-0.0221\r\n\r\n\r\n-0.0103\r\n\r\n\r\n-0.0062\r\n\r\n\r\n0\r\n\r\n\r\n0.0045\r\n\r\n\r\n-0.0010\r\n\r\n\r\n-0.0039\r\n\r\n\r\np_hft_buy\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0050\r\n\r\n\r\n-0.0037\r\n\r\n\r\n0.0038\r\n\r\n\r\n0\r\n\r\n\r\n-0.0040\r\n\r\n\r\n-0.0127\r\n\r\n\r\n-0.0202\r\n\r\n\r\np_hft_sell\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_buy_sell_diff\r\n\r\n\r\n-0.0271\r\n\r\n\r\n-0.0066\r\n\r\n\r\n-0.0100\r\n\r\n\r\n0\r\n\r\n\r\n0.0085\r\n\r\n\r\n0.0117\r\n\r\n\r\n0.0163\r\n\r\n\r\np_hft_buy_sell_diff\r\n\r\n\r\n-0.0020\r\n\r\n\r\n-0.0020\r\n\r\n\r\n-0.0020\r\n\r\n\r\n0\r\n\r\n\r\n0.0034\r\n\r\n\r\n-0.0019\r\n\r\n\r\n0.0097\r\n\r\n\r\navg_hft_inequilibrium\r\n\r\n\r\n-0.6215\r\n\r\n\r\n-0.2284\r\n\r\n\r\n-0.1952\r\n\r\n\r\n0\r\n\r\n\r\n0.1432\r\n\r\n\r\n0.2193\r\n\r\n\r\n0.3510\r\n\r\n\r\np_hft_inequilibrium\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n0\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n0.0004\r\n\r\n\r\nThe table shows that HFT activity reduces taking a buy position\r\nduring negative-end price movements, while it reduces\r\nselling-positioning during positive-end price movements.\r\nIt was 0 (zero) because the p values were too small.\r\nExtreme\r\nprice movements and HFT relationship – Regression models\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.05} +\r\nEPM_{i,t}^{-0.05} + \\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.02} +\r\nEPM_{i,t}^{-0.02} + \\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.05} +\r\nEPM_{i,t}^{-0.05} + Volume_{i,t} + Liquidity_{i,t} + Volatility_{i,t} +\r\n\\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.02} +\r\nEPM_{i,t}^{-0.02} + Volume_{i,t} + Liquidity_{i,t} + Volatility_{i,t} +\r\n\\epsilon_{i,t}\\)\r\nTotal HFT Ratio Determinants\r\n\r\n\r\ndata_all_1 <- data %>% \r\n  select(hft, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft = (hft - mean(hft)) / sd(hft)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_all_1 <- lm(hft ~ `return_type_above 5%` + `return_type_below -5%`, data = data_all_1)\r\nstargazer(model_all_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 5%`           -0.179**          \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`           -0.154*          \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.004           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         1.000 (df = 10167)     \r\nF Statistic               3.589** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_all_2 <- lm(hft ~ `return_type_above 2%` + `return_type_below -2%`, data = data_all_1)\r\nstargazer(model_all_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.115***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`          -0.123***         \r\n                                  (0.034)          \r\n                                                   \r\nConstant                          0.025**          \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.002           \r\nAdjusted R2                        0.002           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              12.039*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_all_2 <- data %>% \r\n  select(hft, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft = (hft - mean(hft)) / sd(hft),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_all_3 <- lm(hft ~ `return_type_above 5%` + `return_type_below -5%` +\r\n                    volume + liquidity + volatility, data = data_all_2)\r\nstargazer(model_all_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 5%`            0.159*           \r\n                                  (0.088)          \r\n                                                   \r\n`return_type_below -5%`           0.230**          \r\n                                  (0.098)          \r\n                                                   \r\nvolume                           -0.246***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         -0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -3.811***         \r\n                                  (0.687)          \r\n                                                   \r\nConstant                         0.096***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.067           \r\nAdjusted R2                        0.067           \r\nResidual Std. Error         0.966 (df = 10164)     \r\nF Statistic             146.079*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_all_4 <- lm(hft ~ `return_type_above 2%` + `return_type_below -2%` + \r\n                    volume + liquidity + volatility, data = data_all_2)\r\nstargazer(model_all_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 2%`            -0.040           \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.029           \r\n                                  (0.034)          \r\n                                                   \r\nvolume                           -0.245***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         -0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.594***         \r\n                                  (0.624)          \r\n                                                   \r\nConstant                         0.076***          \r\n                                  (0.018)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.067           \r\nAdjusted R2                        0.066           \r\nResidual Std. Error         0.966 (df = 10164)     \r\nF Statistic             144.902*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nBuy-side HFT Ratio\r\nDeterminants\r\n\r\n\r\ndata_buy_1 <- data %>% \r\n  select(hft_buy, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_buy = (hft_buy - mean(hft_buy)) / sd(hft_buy)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_buy_1 <- lm(hft_buy ~ `return_type_above 5%` + `return_type_below -5%`, data = data_buy_1)\r\nstargazer(model_buy_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 5%`            -0.037           \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`          -0.336***         \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.004           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              6.599*** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_buy_2 <- lm(hft_buy ~ `return_type_above 2%` + `return_type_below -2%`, data = data_buy_1)\r\nstargazer(model_buy_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 2%`            -0.001           \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`          -0.153***         \r\n                                  (0.034)          \r\n                                                   \r\nConstant                           0.015           \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.002           \r\nAdjusted R2                        0.002           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              10.261*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_buy_2 <- data %>% \r\n  select(hft_buy, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_buy = (hft_buy - mean(hft_buy)) / sd(hft_buy),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_buy_3 <- lm(hft_buy ~ `return_type_above 5%` + `return_type_below -5%` \r\n                  + volume + liquidity + volatility, data = data_buy_2)\r\nstargazer(model_buy_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 5%`           0.256***          \r\n                                  (0.089)          \r\n                                                   \r\n`return_type_below -5%`           -0.004           \r\n                                  (0.099)          \r\n                                                   \r\nvolume                           -0.209***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         0.0004           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -3.339***         \r\n                                  (0.693)          \r\n                                                   \r\nConstant                         0.085***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.049           \r\nAdjusted R2                        0.049           \r\nResidual Std. Error         0.975 (df = 10164)     \r\nF Statistic             105.283*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_buy_4 <- lm(hft_buy ~ `return_type_above 2%` + `return_type_below -2%` \r\n                  + volume + liquidity + volatility, data = data_buy_2)\r\nstargazer(model_buy_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 2%`            0.069**          \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.066*          \r\n                                  (0.035)          \r\n                                                   \r\nvolume                           -0.209***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.658***         \r\n                                  (0.630)          \r\n                                                   \r\nConstant                         0.068***          \r\n                                  (0.019)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.049           \r\nAdjusted R2                        0.049           \r\nResidual Std. Error         0.975 (df = 10164)     \r\nF Statistic             105.651*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nSell Side HFT Ratio\r\nDeterminants\r\n\r\n\r\ndata_sell_1 <- data %>% \r\n  select(hft_sell, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_sell = (hft_sell - mean(hft_sell)) / sd(hft_sell)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_sell_1 <- lm(hft_sell ~ `return_type_above 5%` + `return_type_below -5%`, data = data_sell_1)\r\nstargazer(model_sell_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 5%`           -0.278***         \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`            0.106           \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.003           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              6.165*** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_sell_2 <- lm(hft_sell ~ `return_type_above 2%` + `return_type_below -2%`, data = data_sell_1)\r\nstargazer(model_sell_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.189***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.052           \r\n                                  (0.034)          \r\n                                                   \r\nConstant                          0.027**          \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.004           \r\nAdjusted R2                        0.004           \r\nResidual Std. Error         0.998 (df = 10167)     \r\nF Statistic              19.030*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_sell_2 <- data %>% \r\n  select(hft_sell, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_sell = (hft_sell - mean(hft_sell)) / sd(hft_sell),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_sell_3 <- lm(hft_sell ~ `return_type_above 5%` + `return_type_below -5%` + \r\n                     volume + liquidity + volatility, data = data_sell_2)\r\nstargazer(model_sell_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 5%`            -0.020           \r\n                                  (0.089)          \r\n                                                   \r\n`return_type_below -5%`          0.397***          \r\n                                  (0.099)          \r\n                                                   \r\nvolume                           -0.222***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.007           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.537***         \r\n                                  (0.693)          \r\n                                                   \r\nConstant                         0.063***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.051           \r\nAdjusted R2                        0.051           \r\nResidual Std. Error         0.974 (df = 10164)     \r\nF Statistic             109.717*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_sell_4 <- lm(hft_sell ~ `return_type_above 2%` + `return_type_below -2%` + \r\n                     volume + liquidity + volatility, data = data_sell_2)\r\nstargazer(model_sell_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.134***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`            0.016           \r\n                                  (0.035)          \r\n                                                   \r\nvolume                           -0.222***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.008           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                        -1.232*          \r\n                                  (0.629)          \r\n                                                   \r\nConstant                          0.047**          \r\n                                  (0.019)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.052           \r\nAdjusted R2                        0.051           \r\nResidual Std. Error         0.974 (df = 10164)     \r\nF Statistic             110.402*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nAs a result;\r\nLower HFT activity was observed on stocks and days with extreme price\r\nmovements.\r\nHFT decreased on the sell side during positive extreme price\r\nmovements.\r\nHFT decreased on the buy side during negative extreme price\r\nmovements\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-05-08-hft-en/hft-en_files/figure-html5/unnamed-chunk-8-1.png",
    "last_modified": "2022-05-08T22:38:46+03:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-05-08-hft-tr/",
    "title": "Yüksek Frekanslı İşlemlerin Borsa İstanbul’da Uç Fiyat Hareketleri Çerçevesinde İncelenmesi",
    "description": "Bu çalışmada Borsa İstanbul’da yüksek frekanslı işlemin işlemler ((High Frequency Trading), (HFT))’in varoluşuna ilişkin analizler yaptım. Baz aldığım nokta; uç fiyat hareketleri (((EPM’ler), (Extreme Price Movements)) anındaki yüksek frekanslı işlemlerin davranışlarını ve piyasa payını inceleyeceğim.",
    "author": [
      {
        "name": "Irem Dastan",
        "url": {}
      }
    ],
    "date": "2022-05-08",
    "categories": [
      "Finance",
      "Market Microstructure"
    ],
    "contents": "\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(knitr)\r\nlibrary(kableExtra)\r\nlibrary(ggalt)\r\nlibrary(lubridate)\r\nlibrary(stargazer)\r\nlibrary(fastDummies)\r\n\r\ndata <- read.csv(\"data.csv\") #Veriye Github üzerinden erisebilirsiniz.\r\nnames(data)[1] <- \"stock\" \r\n\r\n\r\n\r\nBu çalışmada Borsa İstanbul’da yüksek frekanslı işlemin ((High\r\nFrequency Trading), (HFT))’in varoluşuna ilişkin analizler yaptım. Baz\r\naldığım nokta; uç fiyat hareketleri (((EPM’ler), (Extreme Price\r\nMovements)) anındaki yüksek frekanslı işlemlerin davranışlarını ve\r\npiyasa payını inceleyeceğim.\r\nBorsaların tamamen otomatik hale gelmesi piyasada gerçekleşen işlem\r\nsayısını artırmış ve aracıların teknoloji kullanımını genişletmelerini\r\nsağlamıştır. Verilerin işlem akışı, piyasa bilgileri akışına hızlı bir\r\nşekilde işlenmesi ve tepki verme yeteneğine dayanan yazılımların\r\narkasında alım satım yapılması, kısa sürede çok sayıda işlem yapılmasını\r\nmümkün kılmıştır. Ancak yine de finansal piyasalarda, yatırım yapmak\r\niçin verilerin kullanılması veya işlemlere hızlı bir şekilde girebilmek\r\niçin süratle ilgili sorunlar vardır. Bu sebeple finansal piyasalarda en\r\nhızlı aktörlerin birbirleriyle rekabet ettikleri bir hız yarışı\r\nmevcuttur. Böylece artık piyasalar insanlar tarafından yapılan\r\nalım-satım işlemleri ile değil, bilgisayar algoritmaları ile domine\r\nedilmektedir.\r\nHFT; bir saniyenin kesirlerinde, binlerce emir gönderimi, yüksek\r\noranda emir iptalleri ve gün içi marjinal kâr hedefi ile\r\nözdeşleştirilebilen saniye veya milisaniye cinsinden pozisyon tutan bir\r\nişlem tipidir. Kısaca; “HFT, düşük milisaniye gecikmelerinde çok sayıda\r\nsipariş gönderme teknolojik yeteneğinden yararlanır” (Ersan ve Ekinci,\r\n2016).\r\nHFT algoritmaları birbirleri ile rekabet ettikçe, iki zorlukla\r\nkarşılaşırlar:\r\nHer mikro saniyede büyük miktarda veri alırlar.\r\nGözlemlenen veriler üzerinde oldukça hızlı hareket edebilmeliler,\r\nçünkü gözlemledikleri sinyallerin kârlılığı çok çabuk azalır.\r\nHFT firmalarının likidite sağlama ve piyasadaki fiyat arbitrajında\r\noynadıkları baskın rol, ticaret alanlarının piyasa payını doğrudan\r\netkiler. Arbitrajlara katılımı kısa süreli alım-satım işlemleri ve\r\nyüksek hacimleriyle küçük fiyat farklarından kâr elde edip böylece\r\nbirden fazla piyasada işlem gören hisselerin fiyat farklarından temin\r\nedilmektedir.\r\n30 Kasım 2015 tarihinde Pay Piyasasında devreye alınan BISTECH\r\nplatformu HFT dahiliyetine imkan vermiştir. Borsa İstanbul’da HFT payı,\r\nABD ve Avrupa ülkeleri kadar gelişmiş değildir.\r\nHFT ile AT (Algorithmic Trading)’nin arasındaki fark; AT daha\r\nkapsamlıdır ve HFT, AT’nin alt kümesidir. AT bilgisayar ortamında\r\ntanımlanan koşullar ile alım satım sağlayan bir yapıdır, HFT ise çok\r\nküçük saniyelerde oluşan fırsatları değerlendirmektedir. Kısacası HFT,\r\nAT’nin bir türüdür.\r\n\r\n\r\n\r\nBIST30 endeksinde listelenen hisse senetleri.\r\n\r\n\r\n\r\nAralık 2015 – Mart 2017 arası 16 aylık dönem, 339 işlem\r\ngünü.\r\n\r\n\r\n\r\nGün-içi emir-işlem defterlerinden elde edilmiş değişkenlerin\r\ngünlük düzeyde tutulan hallerini Ekinci ve Ersan (2020) çalışmasından\r\ntemini.\r\nÇalışmadaki değişkenler; HFT toplam, HFT alım-satım tarafları, HFT\r\nalım-satım farkı (HFT dengesizliği)’dır. Kontrol değişkenleri; işlem\r\nhacmi, likidite ve volatilitedir. Temel bağımsız değişkenler olan kukla\r\ndeğişkenleri ise; uç pozitif fiyat hareketleri (%2 ve %5 üzeri getirili\r\nolan hisse ve günler), ve uç negatif fiyat hareketleri (eksi %2 ve eksi\r\n%5 altı getirili olan hisse ve günler)’dir.\r\nÜç aşamada analizleri yapıyorum.\r\nHisse ve getiri aralığı bazlı\r\nT-test\r\nRegresyon analizi\r\nHFT’nin Hesaplanması\r\nÖncelikle veride bazı emirler HFT emri olarak işaretleniyor. Bunu iki\r\naşamada yapıyoruz.\r\nBirincisi,\r\n1 saniye veya daha kısa sürede gelen en az iki mesaj (emir gönderim,\r\ndeğişiklik, iptal) içeren emirler\r\nİkincisi,\r\naşamada belirlenen HFT emirlerinin herhangi bir mesajı ile aynı\r\nsaniyede ve aynı büyüklükte gelen aynı hissedeki diğer emirler olarak\r\nbelirliyoruz.\r\n\\(HFT\\ ratio_{i,t}=\\frac{Electronic\\\r\nmessage_{i,t}^{HFT}}{Electronic\\ message_{all^{HFT}}}\\)\r\n\\(Liquidity_{i,t}= \\sum_{j=1}^{N}\r\nVolume_{i,j,t}*(\\frac{Duration_{i,j,t}}{Duration_{total}})\\)\r\nAnalizler\r\nGünlük\r\nGetiri Aralıklarında Değişkenlerin İstatistikleri\r\n\r\n\r\ntable1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n      return > -0.02 & return <= 0.02 ~ \"between -2% and 2%\",\r\n      return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_volatility = mean(volatility),\r\n    sd_volatility = sd(volatility),\r\n    avg_liquidity = mean(liquidity),\r\n    sd_liquidity = sd(liquidity),\r\n    avg_hft_buy = mean(hft_buy),\r\n    sd_hft_buy = sd(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    sd_hft_sell = sd(hft_sell),\r\n    avg_hft = mean(hft),\r\n    sd_hft = sd(hft),\r\n    avg_return = mean(return),\r\n    sd_return = sd(return),\r\n    avg_bist30_return = mean(bist30_return),\r\n    sd_bist30_return = sd(bist30_return),\r\n    avg_extra_ret_market = mean(extra_ret_market),\r\n    sd_extra_ret_market = sd(extra_ret_market),\r\n    avg_volume = mean(volume),\r\n    sd_volume = sd(volume)\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  mutate_at(vars(-c(return_type, avg_liquidity, sd_liquidity, avg_volume, sd_volume)),\r\n            .funs = function(x) round(x, digits = 4)) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1)\r\n\r\nkable(table1) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_volatility\r\n\r\n\r\n0.0829\r\n\r\n\r\n0.0391\r\n\r\n\r\n0.0218\r\n\r\n\r\n0.0350\r\n\r\n\r\n0.0765\r\n\r\n\r\nsd_volatility\r\n\r\n\r\n0.0416\r\n\r\n\r\n0.0135\r\n\r\n\r\n0.0107\r\n\r\n\r\n0.0141\r\n\r\n\r\n0.0320\r\n\r\n\r\navg_liquidity\r\n\r\n\r\n41445971\r\n\r\n\r\n30858481\r\n\r\n\r\n27199639\r\n\r\n\r\n29163226\r\n\r\n\r\n30176844\r\n\r\n\r\nsd_liquidity\r\n\r\n\r\n61709828\r\n\r\n\r\n48518623\r\n\r\n\r\n36877463\r\n\r\n\r\n34473672\r\n\r\n\r\n35416041\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n0.0336\r\n\r\n\r\n0.0454\r\n\r\n\r\n0.0551\r\n\r\n\r\n0.0547\r\n\r\n\r\n0.0518\r\n\r\n\r\nsd_hft_buy\r\n\r\n\r\n0.0354\r\n\r\n\r\n0.0548\r\n\r\n\r\n0.0625\r\n\r\n\r\n0.0583\r\n\r\n\r\n0.0525\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0653\r\n\r\n\r\n0.0566\r\n\r\n\r\n0.0603\r\n\r\n\r\n0.0476\r\n\r\n\r\n0.0401\r\n\r\n\r\nsd_hft_sell\r\n\r\n\r\n0.0608\r\n\r\n\r\n0.0600\r\n\r\n\r\n0.0680\r\n\r\n\r\n0.0537\r\n\r\n\r\n0.0456\r\n\r\n\r\navg_hft\r\n\r\n\r\n0.0501\r\n\r\n\r\n0.0531\r\n\r\n\r\n0.0605\r\n\r\n\r\n0.0535\r\n\r\n\r\n0.0487\r\n\r\n\r\nsd_hft\r\n\r\n\r\n0.0415\r\n\r\n\r\n0.0510\r\n\r\n\r\n0.0592\r\n\r\n\r\n0.0506\r\n\r\n\r\n0.0443\r\n\r\n\r\navg_return\r\n\r\n\r\n-0.0700\r\n\r\n\r\n-0.0288\r\n\r\n\r\n-0.0001\r\n\r\n\r\n0.0292\r\n\r\n\r\n0.0710\r\n\r\n\r\nsd_return\r\n\r\n\r\n0.0236\r\n\r\n\r\n0.0073\r\n\r\n\r\n0.0101\r\n\r\n\r\n0.0074\r\n\r\n\r\n0.0283\r\n\r\n\r\navg_bist30_return\r\n\r\n\r\n-0.0278\r\n\r\n\r\n-0.0132\r\n\r\n\r\n0.0007\r\n\r\n\r\n0.0122\r\n\r\n\r\n0.0156\r\n\r\n\r\nsd_bist30_return\r\n\r\n\r\n0.0231\r\n\r\n\r\n0.0130\r\n\r\n\r\n0.0097\r\n\r\n\r\n0.0124\r\n\r\n\r\n0.0157\r\n\r\n\r\navg_extra_ret_market\r\n\r\n\r\n-0.0423\r\n\r\n\r\n-0.0156\r\n\r\n\r\n-0.0007\r\n\r\n\r\n0.0170\r\n\r\n\r\n0.0554\r\n\r\n\r\nsd_extra_ret_market\r\n\r\n\r\n0.0270\r\n\r\n\r\n0.0125\r\n\r\n\r\n0.0100\r\n\r\n\r\n0.0131\r\n\r\n\r\n0.0352\r\n\r\n\r\navg_volume\r\n\r\n\r\n33566193\r\n\r\n\r\n21242601\r\n\r\n\r\n14819716\r\n\r\n\r\n20296933\r\n\r\n\r\n31332308\r\n\r\n\r\nsd_volume\r\n\r\n\r\n51693115\r\n\r\n\r\n32522232\r\n\r\n\r\n23687389\r\n\r\n\r\n27891523\r\n\r\n\r\n45142746\r\n\r\n\r\nLikiditeye bakıldığında ortalama ve standart sapması en büyük\r\nolan %-5 altı getirisiz hisse ve günlere aittir. Piyasa hacmi ortalaması\r\ngetirisiz günlerde en yoğun şekilde yaşanmıştır.\r\nHisse\r\nBazında Getirilerin %2 üzeri ve %-2 altı Günlerinin Sayısı\r\n\r\n\r\ngraph1_1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit() %>% \r\n  pivot_wider(names_from = \"return_type\", values_from = \"number_of_days\")\r\n\r\ngraph1_2 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit()\r\n\r\nggplot(graph1_1, aes(y = stock)) + \r\n  geom_point(data = graph1_2,\r\n             aes(x = number_of_days, color = return_type), size = 3) +\r\n  scale_color_manual(values = c(\"orange\",\"#76a5af\")) +\r\n  geom_dumbbell(aes(x = `below -2%`, xend = `above 2%`),\r\n                size_x = 5, \r\n                size_xend = 5,\r\n                colour_x = \"#76a5af\",\r\n                colour_xend = \"orange\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n        legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"bold\", hjust = 0.5),\r\n        axis.text = element_text(size = 12, face = \"bold\")) +\r\n  guides(color = guide_legend(reverse=T)) +\r\n  labs(title = \"The Number of Days of Returns\")\r\n\r\n\r\n\r\n\r\n%5 üzeri getirili gün sayısının en fazla olduğu hisse senedi\r\nKOZAL’dır, en az günlü olan hisse senetleri ise; ENKAI, KCHOL, PETKM,\r\nSAHOL, TTKOM ve TUPRS’tır.\r\nHisse\r\nBazında Getirilerin %5 üzeri ve %-5 altı Günlerinin Sayısı\r\n\r\n\r\ngraph2_1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit() %>% \r\n  pivot_wider(names_from = \"return_type\", values_from = \"number_of_days\")\r\n\r\ngraph2_2 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit()\r\n\r\nggplot(graph2_1, aes(y = stock)) + \r\n  geom_point(data = graph2_2,\r\n             aes(x = number_of_days, color = return_type), size = 3) +\r\n  scale_color_manual(values = c(\"#80dead\",\"#f1cbff\")) +\r\n  geom_dumbbell(aes(x = `below -5%`, xend = `above 5%`),\r\n                size_x = 5, \r\n                size_xend = 5,\r\n                colour_x = \"#f1cbff\",\r\n                colour_xend = \"#80dead\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n        legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"bold\", hjust = 0.5),\r\n        axis.text = element_text(size = 12, face = \"bold\")) +\r\n  guides(color = guide_legend(reverse=T)) +\r\n  labs(title = \"The Number of Days of Returns\")\r\n\r\n\r\n\r\n\r\nBurada verimiz boyunca seçtiğimiz getiri sınırları dahilinde\r\nHFT’leri belirleyip hisse bazında ortalamasını aldık. Getirisi %-5 altı\r\nHFT ortalaması en fazla olan hisse senedi TTKOM’dur.\r\nAylık\r\nOrtalama HFT Oranı ve Uç Fiyat Hareketli Gün-Hisse Sayısı\r\n\r\n\r\ngraph3 <- data %>%\r\n  select(day, return, hft) %>% \r\n  mutate(day = dmy(day), \r\n         month = month(day),\r\n         year = year(day),\r\n         return_type=case_when(\r\n           return < -0.02 ~ \"below -2%\",\r\n           return > 0.02 ~ \"above 2%\"\r\n    )) %>% \r\n  na.omit() %>% \r\n  group_by(month, year) %>% \r\n  summarise(\"Extreme Price Movements\" = n(),\r\n            \"High Frequency Trading\" = mean(hft)) %>% \r\n  mutate(day = as.Date(paste0(year, \"-\", month, \"-\", 1))) %>% \r\n  arrange(day) %>% \r\n  ungroup() %>% \r\n  select(day, `Extreme Price Movements`, `High Frequency Trading`) %>% \r\n  pivot_longer(!day, names_to = \"types\", values_to = \"value\")\r\n\r\nggplot(graph3, aes(x = day, y = value, group = types, color = types)) +\r\n  geom_line() +\r\n  theme_minimal() + \r\n  theme(axis.title = element_blank(), \r\n        legend.position = \"none\") +\r\n  facet_wrap(~types, scales = \"free_y\", ncol = 1)\r\n\r\n\r\n\r\n\r\nGrafikte sol tarafta değerleri olan EPM’yi ve sağ tarafta\r\noranları bulunan HFT’nin ilişkisini görmekteyiz. EPM’deki uç fiyat\r\noranımız eksi ve artı %2’dir. EPM değerleri, getirideki bu iki uç fiyat\r\ndahilinde gün sayılarının toplamıdır. HFT oranları ise, ay bazında\r\nHFT’lerin toplamının o ayki gün sayısına bölümü ile elde edilmiştir. EPM\r\ngünlerinin sayısı azalmakta ve HFT oranının arttığı görülmektedir. Uç\r\nfiyat hareketinin en az olduğu periyot; Ekim 2016, en fazla olduğu ise\r\nAralık 2015’tir. HFT oranı Mart 2017’de en yüksek seviyeye\r\nulaşmıştır.\r\nGünlük Getiri\r\nAralıklarında HFT Aktivitesi\r\n\r\n\r\ntable2 <- data %>% \r\n  select(hft, hft_buy, hft_sell, return) %>% \r\n  mutate(hft_buy_sell_diff = hft_buy - hft_sell,\r\n         hft_inequilibrium = (hft_buy - hft_sell)/hft, \r\n         return_type=case_when(\r\n           return <= -0.05 ~ \"below -5%\",\r\n           return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n           return > -0.02 & return <= -0.005 ~ \"between -2% and -0.5%\",\r\n           return > -0.005 & return <= 0.005 ~ \"between -0.5% and 0.5%\",\r\n           return > 0.005 & return <= 0.02 ~ \"between 0.5% and 2%\",\r\n           return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n           return > 0.05 ~ \"above 5%\"\r\n    )) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_hft = mean(hft),\r\n    avg_hft_buy = mean(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    avg_hft_buy_sell_diff = mean(hft_buy_sell_diff),\r\n    avg_hft_inequilibrium = mean(hft_inequilibrium, na.rm = T)\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and -0.5%\",\r\n                              \"between -0.5% and 0.5%\",\r\n                              \"between 0.5% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  mutate_at(vars(-c(return_type)), .funs = function(x) round(x, digits = 4)) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1)\r\n\r\nkable(table2) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and -0.5%\r\n\r\n\r\nbetween -0.5% and 0.5%\r\n\r\n\r\nbetween 0.5% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_hft\r\n\r\n\r\n0.0501\r\n\r\n\r\n0.0531\r\n\r\n\r\n0.0596\r\n\r\n\r\n0.0609\r\n\r\n\r\n0.0610\r\n\r\n\r\n0.0535\r\n\r\n\r\n0.0487\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n0.0336\r\n\r\n\r\n0.0454\r\n\r\n\r\n0.0495\r\n\r\n\r\n0.0557\r\n\r\n\r\n0.0602\r\n\r\n\r\n0.0547\r\n\r\n\r\n0.0518\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0653\r\n\r\n\r\n0.0566\r\n\r\n\r\n0.0641\r\n\r\n\r\n0.0603\r\n\r\n\r\n0.0563\r\n\r\n\r\n0.0476\r\n\r\n\r\n0.0401\r\n\r\n\r\navg_hft_buy_sell_diff\r\n\r\n\r\n-0.0317\r\n\r\n\r\n-0.0112\r\n\r\n\r\n-0.0146\r\n\r\n\r\n-0.0046\r\n\r\n\r\n0.0039\r\n\r\n\r\n0.0071\r\n\r\n\r\n0.0117\r\n\r\n\r\navg_hft_inequilibrium\r\n\r\n\r\n-0.6879\r\n\r\n\r\n-0.2948\r\n\r\n\r\n-0.2616\r\n\r\n\r\n-0.0664\r\n\r\n\r\n0.0768\r\n\r\n\r\n0.1529\r\n\r\n\r\n0.2846\r\n\r\n\r\nTabloda farklı getiri aralıklarına giren günlerin HFT\r\ndeğişkenlerinin ortalamaları bulunmaktadır. Eksi %5’ten sıfıra\r\nyaklaşırken HFT ve HFT alım değerleri küçülmekte olup, sıfırdan sonrası\r\niçin büyümektedir. HFT alım ve satım farkında oluşan ortalamalarda ise\r\nsıfıra yaklaşırken küçülüp pozitif EPM’ler durumunda ise ortalamaları\r\nbüyümektedir. HFT farkın HFT ye oranının ortalamasında ise eksi %5 altı\r\nEPM’li hisse ve günlerden itibaren pozitif EPM’li hisse-günlere doğru\r\nyaklaştıkça bu ortalama değer büyümektedir.\r\nUç Fiyat\r\nHareketli gün-hisselerde HFT Aktivitesi\r\n\r\n\r\ntable3 <- data %>% \r\n   select(hft, hft_buy, hft_sell, return) %>% \r\n  mutate(hft_buy_sell_diff = hft_buy - hft_sell,\r\n         hft_inequilibrium = (hft_buy - hft_sell)/hft, \r\n         return_type=case_when(\r\n           return <= -0.05 ~ \"below -5%\",\r\n           return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n           return > -0.02 & return <= -0.005 ~ \"between -2% and -0.5%\",\r\n           return > -0.005 & return <= 0.005 ~ \"between -0.5% and 0.5%\",\r\n           return > 0.005 & return <= 0.02 ~ \"between 0.5% and 2%\",\r\n           return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n           return > 0.05 ~ \"above 5%\"\r\n    )) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_hft = mean(hft),\r\n    avg_hft_buy = mean(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    avg_hft_buy_sell_diff = mean(hft_buy_sell_diff),\r\n    avg_hft_inequilibrium = mean(hft_inequilibrium, na.rm = T),\r\n    p_hft = t.test(hft)$p.value,\r\n    p_hft_buy = t.test(hft_buy)$p.value,\r\n    p_hft_sell = t.test(hft_sell)$p.value,\r\n    p_hft_buy_sell_diff = t.test(hft_buy_sell_diff)$p.value,\r\n    p_hft_inequilibrium = t.test(hft_inequilibrium)$p.value\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and -0.5%\",\r\n                              \"between -0.5% and 0.5%\",\r\n                              \"between 0.5% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  select(return_type, avg_hft, p_hft, avg_hft_buy, p_hft_buy, avg_hft_sell,\r\n         p_hft_sell, avg_hft_buy_sell_diff, p_hft_buy_sell_diff, avg_hft_inequilibrium, p_hft_inequilibrium) %>% \r\n  mutate_at(vars(-c(return_type)), .funs = function(x) round(x, digits = 4)) %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1) %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  mutate_all(.funs = function(x) x - .[,4])\r\n  \r\nkable(table3) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and -0.5%\r\n\r\n\r\nbetween -0.5% and 0.5%\r\n\r\n\r\nbetween 0.5% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_hft\r\n\r\n\r\n-0.0108\r\n\r\n\r\n-0.0078\r\n\r\n\r\n-0.0013\r\n\r\n\r\n0\r\n\r\n\r\n0.0001\r\n\r\n\r\n-0.0074\r\n\r\n\r\n-0.0122\r\n\r\n\r\np_hft\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n-0.0221\r\n\r\n\r\n-0.0103\r\n\r\n\r\n-0.0062\r\n\r\n\r\n0\r\n\r\n\r\n0.0045\r\n\r\n\r\n-0.0010\r\n\r\n\r\n-0.0039\r\n\r\n\r\np_hft_buy\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0050\r\n\r\n\r\n-0.0037\r\n\r\n\r\n0.0038\r\n\r\n\r\n0\r\n\r\n\r\n-0.0040\r\n\r\n\r\n-0.0127\r\n\r\n\r\n-0.0202\r\n\r\n\r\np_hft_sell\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_buy_sell_diff\r\n\r\n\r\n-0.0271\r\n\r\n\r\n-0.0066\r\n\r\n\r\n-0.0100\r\n\r\n\r\n0\r\n\r\n\r\n0.0085\r\n\r\n\r\n0.0117\r\n\r\n\r\n0.0163\r\n\r\n\r\np_hft_buy_sell_diff\r\n\r\n\r\n-0.0020\r\n\r\n\r\n-0.0020\r\n\r\n\r\n-0.0020\r\n\r\n\r\n0\r\n\r\n\r\n0.0034\r\n\r\n\r\n-0.0019\r\n\r\n\r\n0.0097\r\n\r\n\r\navg_hft_inequilibrium\r\n\r\n\r\n-0.6215\r\n\r\n\r\n-0.2284\r\n\r\n\r\n-0.1952\r\n\r\n\r\n0\r\n\r\n\r\n0.1432\r\n\r\n\r\n0.2193\r\n\r\n\r\n0.3510\r\n\r\n\r\np_hft_inequilibrium\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n0\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n0.0004\r\n\r\n\r\nTablo HFT aktivitesinin negatif uç fiyat hareketleri sırasında\r\nalım yönlü pozisyon almayı azalttığını, pozitif uç fiyat hareketleri\r\nsırasında ise satım yönlü pozisyon almayı düşürdüğünü\r\ngöstermektedir.\r\nIt was 0 (zero) because the p values were too small.\r\nUç\r\nfiyat hareketleri ve HFT ilişkisi – Regresyon modelleri\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.05} +\r\nEPM_{i,t}^{-0.05} + \\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.02} +\r\nEPM_{i,t}^{-0.02} + \\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.05} +\r\nEPM_{i,t}^{-0.05} + Volume_{i,t} + Liquidity_{i,t} + Volatility_{i,t} +\r\n\\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.02} +\r\nEPM_{i,t}^{-0.02} + Volume_{i,t} + Liquidity_{i,t} + Volatility_{i,t} +\r\n\\epsilon_{i,t}\\)\r\nToplam HFT Oranı\r\nBelirleyicileri\r\n\r\n\r\ndata_all_1 <- data %>% \r\n  select(hft, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft = (hft - mean(hft)) / sd(hft)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_all_1 <- lm(hft ~ `return_type_above 5%` + `return_type_below -5%`, data = data_all_1)\r\nstargazer(model_all_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 5%`           -0.179**          \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`           -0.154*          \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.004           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         1.000 (df = 10167)     \r\nF Statistic               3.589** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_all_2 <- lm(hft ~ `return_type_above 2%` + `return_type_below -2%`, data = data_all_1)\r\nstargazer(model_all_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.115***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`          -0.123***         \r\n                                  (0.034)          \r\n                                                   \r\nConstant                          0.025**          \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.002           \r\nAdjusted R2                        0.002           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              12.039*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_all_2 <- data %>% \r\n  select(hft, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft = (hft - mean(hft)) / sd(hft),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_all_3 <- lm(hft ~ `return_type_above 5%` + `return_type_below -5%` +\r\n                    volume + liquidity + volatility, data = data_all_2)\r\nstargazer(model_all_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 5%`            0.159*           \r\n                                  (0.088)          \r\n                                                   \r\n`return_type_below -5%`           0.230**          \r\n                                  (0.098)          \r\n                                                   \r\nvolume                           -0.246***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         -0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -3.811***         \r\n                                  (0.687)          \r\n                                                   \r\nConstant                         0.096***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.067           \r\nAdjusted R2                        0.067           \r\nResidual Std. Error         0.966 (df = 10164)     \r\nF Statistic             146.079*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_all_4 <- lm(hft ~ `return_type_above 2%` + `return_type_below -2%` + \r\n                    volume + liquidity + volatility, data = data_all_2)\r\nstargazer(model_all_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 2%`            -0.040           \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.029           \r\n                                  (0.034)          \r\n                                                   \r\nvolume                           -0.245***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         -0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.594***         \r\n                                  (0.624)          \r\n                                                   \r\nConstant                         0.076***          \r\n                                  (0.018)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.067           \r\nAdjusted R2                        0.066           \r\nResidual Std. Error         0.966 (df = 10164)     \r\nF Statistic             144.902*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nAlım tarafı HFT Oranı\r\nBelirleyicileri\r\n\r\n\r\ndata_buy_1 <- data %>% \r\n  select(hft_buy, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_buy = (hft_buy - mean(hft_buy)) / sd(hft_buy)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_buy_1 <- lm(hft_buy ~ `return_type_above 5%` + `return_type_below -5%`, data = data_buy_1)\r\nstargazer(model_buy_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 5%`            -0.037           \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`          -0.336***         \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.004           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              6.599*** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_buy_2 <- lm(hft_buy ~ `return_type_above 2%` + `return_type_below -2%`, data = data_buy_1)\r\nstargazer(model_buy_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 2%`            -0.001           \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`          -0.153***         \r\n                                  (0.034)          \r\n                                                   \r\nConstant                           0.015           \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.002           \r\nAdjusted R2                        0.002           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              10.261*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_buy_2 <- data %>% \r\n  select(hft_buy, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_buy = (hft_buy - mean(hft_buy)) / sd(hft_buy),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_buy_3 <- lm(hft_buy ~ `return_type_above 5%` + `return_type_below -5%` \r\n                  + volume + liquidity + volatility, data = data_buy_2)\r\nstargazer(model_buy_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 5%`           0.256***          \r\n                                  (0.089)          \r\n                                                   \r\n`return_type_below -5%`           -0.004           \r\n                                  (0.099)          \r\n                                                   \r\nvolume                           -0.209***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         0.0004           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -3.339***         \r\n                                  (0.693)          \r\n                                                   \r\nConstant                         0.085***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.049           \r\nAdjusted R2                        0.049           \r\nResidual Std. Error         0.975 (df = 10164)     \r\nF Statistic             105.283*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_buy_4 <- lm(hft_buy ~ `return_type_above 2%` + `return_type_below -2%` \r\n                  + volume + liquidity + volatility, data = data_buy_2)\r\nstargazer(model_buy_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 2%`            0.069**          \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.066*          \r\n                                  (0.035)          \r\n                                                   \r\nvolume                           -0.209***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.658***         \r\n                                  (0.630)          \r\n                                                   \r\nConstant                         0.068***          \r\n                                  (0.019)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.049           \r\nAdjusted R2                        0.049           \r\nResidual Std. Error         0.975 (df = 10164)     \r\nF Statistic             105.651*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nSatım Tarafı HFT Oranı\r\nBelirleyicileri\r\n\r\n\r\ndata_sell_1 <- data %>% \r\n  select(hft_sell, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_sell = (hft_sell - mean(hft_sell)) / sd(hft_sell)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_sell_1 <- lm(hft_sell ~ `return_type_above 5%` + `return_type_below -5%`, data = data_sell_1)\r\nstargazer(model_sell_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 5%`           -0.278***         \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`            0.106           \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.003           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              6.165*** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_sell_2 <- lm(hft_sell ~ `return_type_above 2%` + `return_type_below -2%`, data = data_sell_1)\r\nstargazer(model_sell_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.189***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.052           \r\n                                  (0.034)          \r\n                                                   \r\nConstant                          0.027**          \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.004           \r\nAdjusted R2                        0.004           \r\nResidual Std. Error         0.998 (df = 10167)     \r\nF Statistic              19.030*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_sell_2 <- data %>% \r\n  select(hft_sell, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_sell = (hft_sell - mean(hft_sell)) / sd(hft_sell),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_sell_3 <- lm(hft_sell ~ `return_type_above 5%` + `return_type_below -5%` + \r\n                     volume + liquidity + volatility, data = data_sell_2)\r\nstargazer(model_sell_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 5%`            -0.020           \r\n                                  (0.089)          \r\n                                                   \r\n`return_type_below -5%`          0.397***          \r\n                                  (0.099)          \r\n                                                   \r\nvolume                           -0.222***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.007           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.537***         \r\n                                  (0.693)          \r\n                                                   \r\nConstant                         0.063***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.051           \r\nAdjusted R2                        0.051           \r\nResidual Std. Error         0.974 (df = 10164)     \r\nF Statistic             109.717*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_sell_4 <- lm(hft_sell ~ `return_type_above 2%` + `return_type_below -2%` + \r\n                     volume + liquidity + volatility, data = data_sell_2)\r\nstargazer(model_sell_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.134***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`            0.016           \r\n                                  (0.035)          \r\n                                                   \r\nvolume                           -0.222***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.008           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                        -1.232*          \r\n                                  (0.629)          \r\n                                                   \r\nConstant                          0.047**          \r\n                                  (0.019)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.052           \r\nAdjusted R2                        0.051           \r\nResidual Std. Error         0.974 (df = 10164)     \r\nF Statistic             110.402*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nSonuç olarak;\r\nHisse senetlerinde ve aşırı fiyat hareketlerinin olduğu günlerde daha\r\ndüşük HFT aktivitesi gözlemlenmiştir.\r\nPozitif aşırı fiyat hareketleri sırasında satış tarafında HFT\r\nazalmıştır.\r\nNegatif aşırı fiyat hareketleri sırasında HFT alış tarafında\r\nazalmıştır.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-05-08-hft-tr/hft-tr_files/figure-html5/unnamed-chunk-8-1.png",
    "last_modified": "2022-05-08T23:37:00+03:00",
    "input_file": {}
  }
]
