[
  {
    "path": "posts/2022-05-08-hft-en/",
    "title": "Investigating High-Frequency Trading (HFT) Around the Extreme Price Movements in Borsa Istanbul",
    "description": "In this study, I analyzed the existence of high-frequency trading (HFT) in Borsa Istanbul. My focus is it's the behavior and market share of high-frequency trading during extreme price movements (EPM).",
    "author": [
      {
        "name": "Irem Dastan",
        "url": {}
      }
    ],
    "date": "2022-05-08",
    "categories": [
      "Finance",
      "Market Microstructure"
    ],
    "contents": "\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(knitr)\r\nlibrary(kableExtra)\r\nlibrary(ggalt)\r\nlibrary(lubridate)\r\nlibrary(stargazer)\r\nlibrary(fastDummies)\r\n\r\ndata <- read.csv(\"data.csv\") #You can access the data on Github.\r\nnames(data)[1] <- \"stock\" \r\n\r\n\r\n\r\nIn this study, I analyzed the existence of high-frequency trading\r\n(HFT) in Borsa Istanbul. My focus is it’s the behavior and market share\r\nof high-frequency trading during extreme price movements (EPM).\r\nFully automated exchanges have increased the number of transactions\r\nin the market and enabled intermediaries to expand their use of\r\ntechnology. Trading behind software based on the ability to process and\r\nreact quickly to the trading flow of data, to the flow of market\r\ninformation has made it possible to carry out a large number of trading\r\nin a short time. However, there are still problems with speed in\r\nfinancial markets, using data to invest or to enter trades quickly. For\r\nthis reason, there is a speed race in which the fastest actors compete\r\nwith each other in financial markets. Thus, the markets are now\r\ndominated by computer algorithms, not by buying and selling tradings\r\nmade by humans.\r\nHFT; It is a type of trading that can be defined with thousands of\r\norder submissions, high order cancellations and intraday marginal profit\r\ntarget, keeping positions in seconds or milliseconds in fractions of a\r\nsecond. Briefly; “HFT leverages the technological capability of sending\r\nlarge numbers of orders at low millisecond delays” (Ersan and Ekinci,\r\n2016).\r\nAs HFT algorithms compete with each other, they face two\r\nchallenges:\r\nThey receive large amounts of data every microsecond.\r\nThey must be able to act very quickly on the observed data,\r\nbecause the profitability of the signals they observe decreases very\r\nquickly.\r\nThe dominant role played by HFT firms in providing liquidity and\r\nprice arbitrage in the market directly affects the market share of\r\ntrading areas. Its participation in arbitrages is obtained from the\r\nprice differences of the shares traded in more than one market, by\r\nmaking profit from small price differences with short-term trading and\r\nhigh volumes.\r\nBISTECH platform, which was put into use in the Equity Market on\r\nNovember 30, 2015, allowed the inclusion of HFT. HFT share in Borsa\r\nIstanbul is not as developed as the USA and European countries.\r\nThe difference between HFT and AT (Algorithmic Trading); AT is more\r\ncomprehensive and HFT is a subset of AT. AT is a structure that provides\r\ntrading with conditions defined in the computer environment, while HFT\r\nevaluates the opportunities that occur in very small seconds. In short,\r\nHFT is a variant of AT.\r\n\r\n\r\n\r\nStocks listed in BIST30 index.\r\n\r\n\r\n\r\n16-month period from December 2015 to March 2017, 339 trading\r\ndays.\r\n\r\n\r\n\r\nObtaining the daily versions of the variables obtained from the\r\nintraday order-trading books from the study of Ekinci and Ersan\r\n(2020).\r\nVariables in the study; HFT total, HFT trading sides, HFT trading\r\ndifference (HFT imbalance). Control variables; trading volume, liquidity\r\nand volatility. The dummy variables, which are the main independent\r\nvariables, are; extreme positive price movements (shares and days with\r\nreturns of 2% and more than 5%), and extreme negative price movements\r\n(stocks and days with returns below -2% and -5%).\r\nI analyze in three stages.\r\nBased on stock and return range\r\nT-test\r\nRegression analysis\r\nCalculating the HFT\r\nFirst of all, some orders are marked as HFT orders in the data. We do\r\nthis in two stages.\r\nFirst, orders with at least two messages (order submission,\r\nchange, cancellation) in 1 second or less.\r\nLatter, we determine it as any message of the HFT orders\r\ndetermined in the 1st stage, as other orders of the same stock that come\r\nin the same second and in the same size.\r\n\\(HFT\\ ratio_{i,t}=\\frac{Electronic\\\r\nmessage_{i,t}^{HFT}}{Electronic\\ message_{all^{HFT}}}\\)\r\n\\(Liquidity_{i,t}= \\sum_{j=1}^{N}\r\nVolume_{i,j,t}*(\\frac{Duration_{i,j,t}}{Duration_{total}})\\)\r\nAnalyzes\r\nStatistics of\r\nVariables in Daily Return Ranges\r\n\r\n\r\ntable1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n      return > -0.02 & return <= 0.02 ~ \"between -2% and 2%\",\r\n      return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_volatility = mean(volatility),\r\n    sd_volatility = sd(volatility),\r\n    avg_liquidity = mean(liquidity),\r\n    sd_liquidity = sd(liquidity),\r\n    avg_hft_buy = mean(hft_buy),\r\n    sd_hft_buy = sd(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    sd_hft_sell = sd(hft_sell),\r\n    avg_hft = mean(hft),\r\n    sd_hft = sd(hft),\r\n    avg_return = mean(return),\r\n    sd_return = sd(return),\r\n    avg_bist30_return = mean(bist30_return),\r\n    sd_bist30_return = sd(bist30_return),\r\n    avg_extra_ret_market = mean(extra_ret_market),\r\n    sd_extra_ret_market = sd(extra_ret_market),\r\n    avg_volume = mean(volume),\r\n    sd_volume = sd(volume)\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  mutate_at(vars(-c(return_type, avg_liquidity, sd_liquidity, avg_volume, sd_volume)),\r\n            .funs = function(x) round(x, digits = 4)) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1)\r\n\r\nkable(table1) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_volatility\r\n\r\n\r\n0.0829\r\n\r\n\r\n0.0391\r\n\r\n\r\n0.0218\r\n\r\n\r\n0.0350\r\n\r\n\r\n0.0765\r\n\r\n\r\nsd_volatility\r\n\r\n\r\n0.0416\r\n\r\n\r\n0.0135\r\n\r\n\r\n0.0107\r\n\r\n\r\n0.0141\r\n\r\n\r\n0.0320\r\n\r\n\r\navg_liquidity\r\n\r\n\r\n41445971\r\n\r\n\r\n30858481\r\n\r\n\r\n27199639\r\n\r\n\r\n29163226\r\n\r\n\r\n30176844\r\n\r\n\r\nsd_liquidity\r\n\r\n\r\n61709828\r\n\r\n\r\n48518623\r\n\r\n\r\n36877463\r\n\r\n\r\n34473672\r\n\r\n\r\n35416041\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n0.0336\r\n\r\n\r\n0.0454\r\n\r\n\r\n0.0551\r\n\r\n\r\n0.0547\r\n\r\n\r\n0.0518\r\n\r\n\r\nsd_hft_buy\r\n\r\n\r\n0.0354\r\n\r\n\r\n0.0548\r\n\r\n\r\n0.0625\r\n\r\n\r\n0.0583\r\n\r\n\r\n0.0525\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0653\r\n\r\n\r\n0.0566\r\n\r\n\r\n0.0603\r\n\r\n\r\n0.0476\r\n\r\n\r\n0.0401\r\n\r\n\r\nsd_hft_sell\r\n\r\n\r\n0.0608\r\n\r\n\r\n0.0600\r\n\r\n\r\n0.0680\r\n\r\n\r\n0.0537\r\n\r\n\r\n0.0456\r\n\r\n\r\navg_hft\r\n\r\n\r\n0.0501\r\n\r\n\r\n0.0531\r\n\r\n\r\n0.0605\r\n\r\n\r\n0.0535\r\n\r\n\r\n0.0487\r\n\r\n\r\nsd_hft\r\n\r\n\r\n0.0415\r\n\r\n\r\n0.0510\r\n\r\n\r\n0.0592\r\n\r\n\r\n0.0506\r\n\r\n\r\n0.0443\r\n\r\n\r\navg_return\r\n\r\n\r\n-0.0700\r\n\r\n\r\n-0.0288\r\n\r\n\r\n-0.0001\r\n\r\n\r\n0.0292\r\n\r\n\r\n0.0710\r\n\r\n\r\nsd_return\r\n\r\n\r\n0.0236\r\n\r\n\r\n0.0073\r\n\r\n\r\n0.0101\r\n\r\n\r\n0.0074\r\n\r\n\r\n0.0283\r\n\r\n\r\navg_bist30_return\r\n\r\n\r\n-0.0278\r\n\r\n\r\n-0.0132\r\n\r\n\r\n0.0007\r\n\r\n\r\n0.0122\r\n\r\n\r\n0.0156\r\n\r\n\r\nsd_bist30_return\r\n\r\n\r\n0.0231\r\n\r\n\r\n0.0130\r\n\r\n\r\n0.0097\r\n\r\n\r\n0.0124\r\n\r\n\r\n0.0157\r\n\r\n\r\navg_extra_ret_market\r\n\r\n\r\n-0.0423\r\n\r\n\r\n-0.0156\r\n\r\n\r\n-0.0007\r\n\r\n\r\n0.0170\r\n\r\n\r\n0.0554\r\n\r\n\r\nsd_extra_ret_market\r\n\r\n\r\n0.0270\r\n\r\n\r\n0.0125\r\n\r\n\r\n0.0100\r\n\r\n\r\n0.0131\r\n\r\n\r\n0.0352\r\n\r\n\r\navg_volume\r\n\r\n\r\n33566193\r\n\r\n\r\n21242601\r\n\r\n\r\n14819716\r\n\r\n\r\n20296933\r\n\r\n\r\n31332308\r\n\r\n\r\nsd_volume\r\n\r\n\r\n51693115\r\n\r\n\r\n32522232\r\n\r\n\r\n23687389\r\n\r\n\r\n27891523\r\n\r\n\r\n45142746\r\n\r\n\r\nConsidering the liquidity, the average and standard deviation\r\nbelow -5% belong to non-return stocks and days. The average market\r\nvolume was experienced most intensely on non-return days.\r\nNumber\r\nof Days Above 2% and Below -2% of Returns on a Stock Basis\r\n\r\n\r\ngraph1_1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit() %>% \r\n  pivot_wider(names_from = \"return_type\", values_from = \"number_of_days\")\r\n\r\ngraph1_2 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit()\r\n\r\nggplot(graph1_1, aes(y = stock)) + \r\n  geom_point(data = graph1_2,\r\n             aes(x = number_of_days, color = return_type), size = 3) +\r\n  scale_color_manual(values = c(\"orange\",\"#76a5af\")) +\r\n  geom_dumbbell(aes(x = `below -2%`, xend = `above 2%`),\r\n                size_x = 5, \r\n                size_xend = 5,\r\n                colour_x = \"#76a5af\",\r\n                colour_xend = \"orange\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n        legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"bold\", hjust = 0.5),\r\n        axis.text = element_text(size = 12, face = \"bold\")) +\r\n  guides(color = guide_legend(reverse=T)) +\r\n  labs(title = \"The Number of Days of Returns\")\r\n\r\n\r\n\r\n\r\nThe stock with the highest number of days with a return of more\r\nthan 5% is KOZAL, and the stocks with the least number of days; ENKAI,\r\nKCHOL, PETKM, SAHOL, TTKOM and TUPRS.\r\nNumber\r\nof Days Above 5% and Under -5% of Returns on a Stock Basis\r\n\r\n\r\ngraph2_1 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit() %>% \r\n  pivot_wider(names_from = \"return_type\", values_from = \"number_of_days\")\r\n\r\ngraph2_2 <- data %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return < -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\"\r\n    )\r\n  ) %>% \r\n  group_by(stock, return_type) %>% \r\n  summarise(number_of_days = n()) %>% \r\n  na.omit()\r\n\r\nggplot(graph2_1, aes(y = stock)) + \r\n  geom_point(data = graph2_2,\r\n             aes(x = number_of_days, color = return_type), size = 3) +\r\n  scale_color_manual(values = c(\"#80dead\",\"#f1cbff\")) +\r\n  geom_dumbbell(aes(x = `below -5%`, xend = `above 5%`),\r\n                size_x = 5, \r\n                size_xend = 5,\r\n                colour_x = \"#f1cbff\",\r\n                colour_xend = \"#80dead\") +\r\n  theme_minimal() +\r\n  theme(axis.title = element_blank(),\r\n        legend.title = element_blank(),\r\n        legend.position = \"top\",\r\n        plot.title = element_text(face = \"bold\", hjust = 0.5),\r\n        axis.text = element_text(size = 12, face = \"bold\")) +\r\n  guides(color = guide_legend(reverse=T)) +\r\n  labs(title = \"The Number of Days of Returns\")\r\n\r\n\r\n\r\n\r\nHere, we determined the HFTs within the return limits we chose\r\nthroughout our data and averaged them on a share basis. The stock with\r\nthe highest return under -5% HFT average is TTKOM.\r\nMonthly\r\nAverage HFT Rate and Extreme Price Moving Days and Number of Stocks\r\n\r\n\r\ngraph3 <- data %>%\r\n  select(day, return, hft) %>% \r\n  mutate(day = dmy(day), \r\n         month = month(day),\r\n         year = year(day),\r\n         return_type=case_when(\r\n           return < -0.02 ~ \"below -2%\",\r\n           return > 0.02 ~ \"above 2%\"\r\n    )) %>% \r\n  na.omit() %>% \r\n  group_by(month, year) %>% \r\n  summarise(\"Extreme Price Movements\" = n(),\r\n            \"High Frequency Trading\" = mean(hft)) %>% \r\n  mutate(day = as.Date(paste0(year, \"-\", month, \"-\", 1))) %>% \r\n  arrange(day) %>% \r\n  ungroup() %>% \r\n  select(day, `Extreme Price Movements`, `High Frequency Trading`) %>% \r\n  pivot_longer(!day, names_to = \"types\", values_to = \"value\")\r\n\r\nggplot(graph3, aes(x = day, y = value, group = types, color = types)) +\r\n  geom_line() +\r\n  theme_minimal() + \r\n  theme(axis.title = element_blank(), \r\n        legend.position = \"none\") +\r\n  facet_wrap(~types, scales = \"free_y\", ncol = 1)\r\n\r\n\r\n\r\n\r\nIn the graph, we see the relationship of EPM with values on the\r\nleft and HFT with ratios on the right. Our tipping rate in EPM is minus\r\nand plus 2%. The EPM values are the sum of the days within these two\r\nextreme prices in the return. HFT rates are obtained by dividing the sum\r\nof HFTs on a monthly basis by the number of days in that month. It is\r\nseen that the number of EPM days is decreasing and the HFT ratio is\r\nincreasing. The period with the least extreme price movement; October\r\n2016, the highest is December 2015. The HFT rate reached its highest\r\nlevel in March 2017.\r\nHFT Activity in Daily\r\nReturn Ranges\r\n\r\n\r\ntable2 <- data %>% \r\n  select(hft, hft_buy, hft_sell, return) %>% \r\n  mutate(hft_buy_sell_diff = hft_buy - hft_sell,\r\n         hft_inequilibrium = (hft_buy - hft_sell)/hft, \r\n         return_type=case_when(\r\n           return <= -0.05 ~ \"below -5%\",\r\n           return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n           return > -0.02 & return <= -0.005 ~ \"between -2% and -0.5%\",\r\n           return > -0.005 & return <= 0.005 ~ \"between -0.5% and 0.5%\",\r\n           return > 0.005 & return <= 0.02 ~ \"between 0.5% and 2%\",\r\n           return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n           return > 0.05 ~ \"above 5%\"\r\n    )) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_hft = mean(hft),\r\n    avg_hft_buy = mean(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    avg_hft_buy_sell_diff = mean(hft_buy_sell_diff),\r\n    avg_hft_inequilibrium = mean(hft_inequilibrium, na.rm = T)\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and -0.5%\",\r\n                              \"between -0.5% and 0.5%\",\r\n                              \"between 0.5% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  mutate_at(vars(-c(return_type)), .funs = function(x) round(x, digits = 4)) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1)\r\n\r\nkable(table2) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and -0.5%\r\n\r\n\r\nbetween -0.5% and 0.5%\r\n\r\n\r\nbetween 0.5% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_hft\r\n\r\n\r\n0.0501\r\n\r\n\r\n0.0531\r\n\r\n\r\n0.0596\r\n\r\n\r\n0.0609\r\n\r\n\r\n0.0610\r\n\r\n\r\n0.0535\r\n\r\n\r\n0.0487\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n0.0336\r\n\r\n\r\n0.0454\r\n\r\n\r\n0.0495\r\n\r\n\r\n0.0557\r\n\r\n\r\n0.0602\r\n\r\n\r\n0.0547\r\n\r\n\r\n0.0518\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0653\r\n\r\n\r\n0.0566\r\n\r\n\r\n0.0641\r\n\r\n\r\n0.0603\r\n\r\n\r\n0.0563\r\n\r\n\r\n0.0476\r\n\r\n\r\n0.0401\r\n\r\n\r\navg_hft_buy_sell_diff\r\n\r\n\r\n-0.0317\r\n\r\n\r\n-0.0112\r\n\r\n\r\n-0.0146\r\n\r\n\r\n-0.0046\r\n\r\n\r\n0.0039\r\n\r\n\r\n0.0071\r\n\r\n\r\n0.0117\r\n\r\n\r\navg_hft_inequilibrium\r\n\r\n\r\n-0.6879\r\n\r\n\r\n-0.2948\r\n\r\n\r\n-0.2616\r\n\r\n\r\n-0.0664\r\n\r\n\r\n0.0768\r\n\r\n\r\n0.1529\r\n\r\n\r\n0.2846\r\n\r\n\r\nIn the table, there are the averages of the HFT variables of the\r\ndays that fall into different return ranges. When approaching from minus\r\n5% to zero, the HFT and HFT purchase values decrease and grow after\r\nzero. In the averages of the HFT buying and selling difference, while it\r\napproaches zero, it shrinks and in the case of positive EPMs, the\r\naverages increase. In the average of the ratio of the HFT difference to\r\nthe HFT, this average value grows as the stocks and days with an EPM\r\nbelow -5% get closer to the stocks and days with a positive\r\nEPM.\r\nHFT\r\nActivity on Extreme Price Moving Days and Stocks\r\n\r\n\r\ntable3 <- data %>% \r\n   select(hft, hft_buy, hft_sell, return) %>% \r\n  mutate(hft_buy_sell_diff = hft_buy - hft_sell,\r\n         hft_inequilibrium = (hft_buy - hft_sell)/hft, \r\n         return_type=case_when(\r\n           return <= -0.05 ~ \"below -5%\",\r\n           return > -0.05 & return <= -0.02 ~ \"between -5% and -2%\",\r\n           return > -0.02 & return <= -0.005 ~ \"between -2% and -0.5%\",\r\n           return > -0.005 & return <= 0.005 ~ \"between -0.5% and 0.5%\",\r\n           return > 0.005 & return <= 0.02 ~ \"between 0.5% and 2%\",\r\n           return > 0.02 & return <= 0.05 ~ \"between 2% and 5%\",\r\n           return > 0.05 ~ \"above 5%\"\r\n    )) %>% \r\n  group_by(return_type) %>% \r\n  summarise(\r\n    avg_hft = mean(hft),\r\n    avg_hft_buy = mean(hft_buy),\r\n    avg_hft_sell = mean(hft_sell),\r\n    avg_hft_buy_sell_diff = mean(hft_buy_sell_diff),\r\n    avg_hft_inequilibrium = mean(hft_inequilibrium, na.rm = T),\r\n    p_hft = t.test(hft)$p.value,\r\n    p_hft_buy = t.test(hft_buy)$p.value,\r\n    p_hft_sell = t.test(hft_sell)$p.value,\r\n    p_hft_buy_sell_diff = t.test(hft_buy_sell_diff)$p.value,\r\n    p_hft_inequilibrium = t.test(hft_inequilibrium)$p.value\r\n  ) %>% \r\n  mutate(\r\n    return_type = factor(\r\n      return_type, levels = c(\"below -5%\",\r\n                              \"between -5% and -2%\",\r\n                              \"between -2% and -0.5%\",\r\n                              \"between -0.5% and 0.5%\",\r\n                              \"between 0.5% and 2%\",\r\n                              \"between 2% and 5%\",\r\n                              \"above 5%\")\r\n    )\r\n  ) %>% \r\n  arrange(return_type) %>% \r\n  select(return_type, avg_hft, p_hft, avg_hft_buy, p_hft_buy, avg_hft_sell,\r\n         p_hft_sell, avg_hft_buy_sell_diff, p_hft_buy_sell_diff, avg_hft_inequilibrium, p_hft_inequilibrium) %>% \r\n  mutate_at(vars(-c(return_type)), .funs = function(x) round(x, digits = 4)) %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  t() %>% \r\n  as.data.frame() %>% \r\n  `colnames<-`(.[1,]) %>% \r\n  slice(-1) %>% \r\n  mutate_if(is.character, as.numeric) %>% \r\n  mutate_all(.funs = function(x) x - .[,4])\r\n  \r\nkable(table3) %>% \r\n  kable_paper(\"hover\", full_width = F)\r\n\r\n\r\n\r\n\r\n\r\nbelow -5%\r\n\r\n\r\nbetween -5% and -2%\r\n\r\n\r\nbetween -2% and -0.5%\r\n\r\n\r\nbetween -0.5% and 0.5%\r\n\r\n\r\nbetween 0.5% and 2%\r\n\r\n\r\nbetween 2% and 5%\r\n\r\n\r\nabove 5%\r\n\r\n\r\navg_hft\r\n\r\n\r\n-0.0108\r\n\r\n\r\n-0.0078\r\n\r\n\r\n-0.0013\r\n\r\n\r\n0\r\n\r\n\r\n0.0001\r\n\r\n\r\n-0.0074\r\n\r\n\r\n-0.0122\r\n\r\n\r\np_hft\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_buy\r\n\r\n\r\n-0.0221\r\n\r\n\r\n-0.0103\r\n\r\n\r\n-0.0062\r\n\r\n\r\n0\r\n\r\n\r\n0.0045\r\n\r\n\r\n-0.0010\r\n\r\n\r\n-0.0039\r\n\r\n\r\np_hft_buy\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_sell\r\n\r\n\r\n0.0050\r\n\r\n\r\n-0.0037\r\n\r\n\r\n0.0038\r\n\r\n\r\n0\r\n\r\n\r\n-0.0040\r\n\r\n\r\n-0.0127\r\n\r\n\r\n-0.0202\r\n\r\n\r\np_hft_sell\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\n0.0000\r\n\r\n\r\navg_hft_buy_sell_diff\r\n\r\n\r\n-0.0271\r\n\r\n\r\n-0.0066\r\n\r\n\r\n-0.0100\r\n\r\n\r\n0\r\n\r\n\r\n0.0085\r\n\r\n\r\n0.0117\r\n\r\n\r\n0.0163\r\n\r\n\r\np_hft_buy_sell_diff\r\n\r\n\r\n-0.0020\r\n\r\n\r\n-0.0020\r\n\r\n\r\n-0.0020\r\n\r\n\r\n0\r\n\r\n\r\n0.0034\r\n\r\n\r\n-0.0019\r\n\r\n\r\n0.0097\r\n\r\n\r\navg_hft_inequilibrium\r\n\r\n\r\n-0.6215\r\n\r\n\r\n-0.2284\r\n\r\n\r\n-0.1952\r\n\r\n\r\n0\r\n\r\n\r\n0.1432\r\n\r\n\r\n0.2193\r\n\r\n\r\n0.3510\r\n\r\n\r\np_hft_inequilibrium\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n0\r\n\r\n\r\n-0.0005\r\n\r\n\r\n-0.0005\r\n\r\n\r\n0.0004\r\n\r\n\r\nThe table shows that HFT activity reduces taking a buy position\r\nduring negative-end price movements, while it reduces\r\nselling-positioning during positive-end price movements.\r\nIt was 0 (zero) because the p values were too small.\r\nExtreme\r\nprice movements and HFT relationship – Regression models\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.05} +\r\nEPM_{i,t}^{-0.05} + \\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.02} +\r\nEPM_{i,t}^{-0.02} + \\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.05} +\r\nEPM_{i,t}^{-0.05} + Volume_{i,t} + Liquidity_{i,t} + Volatility_{i,t} +\r\n\\epsilon_{i,t}\\)\r\n\\(HFT_{i,t}= EPM_{i,t}^{+0.02} +\r\nEPM_{i,t}^{-0.02} + Volume_{i,t} + Liquidity_{i,t} + Volatility_{i,t} +\r\n\\epsilon_{i,t}\\)\r\nTotal HFT Ratio Determinants\r\n\r\n\r\ndata_all_1 <- data %>% \r\n  select(hft, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft = (hft - mean(hft)) / sd(hft)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_all_1 <- lm(hft ~ `return_type_above 5%` + `return_type_below -5%`, data = data_all_1)\r\nstargazer(model_all_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 5%`           -0.179**          \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`           -0.154*          \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.004           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         1.000 (df = 10167)     \r\nF Statistic               3.589** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_all_2 <- lm(hft ~ `return_type_above 2%` + `return_type_below -2%`, data = data_all_1)\r\nstargazer(model_all_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.115***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`          -0.123***         \r\n                                  (0.034)          \r\n                                                   \r\nConstant                          0.025**          \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.002           \r\nAdjusted R2                        0.002           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              12.039*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_all_2 <- data %>% \r\n  select(hft, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft = (hft - mean(hft)) / sd(hft),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_all_3 <- lm(hft ~ `return_type_above 5%` + `return_type_below -5%` +\r\n                    volume + liquidity + volatility, data = data_all_2)\r\nstargazer(model_all_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 5%`            0.159*           \r\n                                  (0.088)          \r\n                                                   \r\n`return_type_below -5%`           0.230**          \r\n                                  (0.098)          \r\n                                                   \r\nvolume                           -0.246***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         -0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -3.811***         \r\n                                  (0.687)          \r\n                                                   \r\nConstant                         0.096***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.067           \r\nAdjusted R2                        0.067           \r\nResidual Std. Error         0.966 (df = 10164)     \r\nF Statistic             146.079*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_all_4 <- lm(hft ~ `return_type_above 2%` + `return_type_below -2%` + \r\n                    volume + liquidity + volatility, data = data_all_2)\r\nstargazer(model_all_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                    hft            \r\n---------------------------------------------------\r\n`return_type_above 2%`            -0.040           \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.029           \r\n                                  (0.034)          \r\n                                                   \r\nvolume                           -0.245***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         -0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.594***         \r\n                                  (0.624)          \r\n                                                   \r\nConstant                         0.076***          \r\n                                  (0.018)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.067           \r\nAdjusted R2                        0.066           \r\nResidual Std. Error         0.966 (df = 10164)     \r\nF Statistic             144.902*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nBuy-side HFT Ratio\r\nDeterminants\r\n\r\n\r\ndata_buy_1 <- data %>% \r\n  select(hft_buy, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_buy = (hft_buy - mean(hft_buy)) / sd(hft_buy)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_buy_1 <- lm(hft_buy ~ `return_type_above 5%` + `return_type_below -5%`, data = data_buy_1)\r\nstargazer(model_buy_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 5%`            -0.037           \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`          -0.336***         \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.004           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              6.599*** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_buy_2 <- lm(hft_buy ~ `return_type_above 2%` + `return_type_below -2%`, data = data_buy_1)\r\nstargazer(model_buy_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 2%`            -0.001           \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`          -0.153***         \r\n                                  (0.034)          \r\n                                                   \r\nConstant                           0.015           \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.002           \r\nAdjusted R2                        0.002           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              10.261*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_buy_2 <- data %>% \r\n  select(hft_buy, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_buy = (hft_buy - mean(hft_buy)) / sd(hft_buy),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_buy_3 <- lm(hft_buy ~ `return_type_above 5%` + `return_type_below -5%` \r\n                  + volume + liquidity + volatility, data = data_buy_2)\r\nstargazer(model_buy_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 5%`           0.256***          \r\n                                  (0.089)          \r\n                                                   \r\n`return_type_below -5%`           -0.004           \r\n                                  (0.099)          \r\n                                                   \r\nvolume                           -0.209***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                         0.0004           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -3.339***         \r\n                                  (0.693)          \r\n                                                   \r\nConstant                         0.085***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.049           \r\nAdjusted R2                        0.049           \r\nResidual Std. Error         0.975 (df = 10164)     \r\nF Statistic             105.283*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_buy_4 <- lm(hft_buy ~ `return_type_above 2%` + `return_type_below -2%` \r\n                  + volume + liquidity + volatility, data = data_buy_2)\r\nstargazer(model_buy_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                  hft_buy          \r\n---------------------------------------------------\r\n`return_type_above 2%`            0.069**          \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.066*          \r\n                                  (0.035)          \r\n                                                   \r\nvolume                           -0.209***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.001           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.658***         \r\n                                  (0.630)          \r\n                                                   \r\nConstant                         0.068***          \r\n                                  (0.019)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.049           \r\nAdjusted R2                        0.049           \r\nResidual Std. Error         0.975 (df = 10164)     \r\nF Statistic             105.651*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nSell Side HFT Ratio\r\nDeterminants\r\n\r\n\r\ndata_sell_1 <- data %>% \r\n  select(hft_sell, return) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_sell = (hft_sell - mean(hft_sell)) / sd(hft_sell)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_sell_1 <- lm(hft_sell ~ `return_type_above 5%` + `return_type_below -5%`, data = data_sell_1)\r\nstargazer(model_sell_1, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 5%`           -0.278***         \r\n                                  (0.084)          \r\n                                                   \r\n`return_type_below -5%`            0.106           \r\n                                  (0.093)          \r\n                                                   \r\nConstant                           0.003           \r\n                                  (0.010)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.001           \r\nAdjusted R2                        0.001           \r\nResidual Std. Error         0.999 (df = 10167)     \r\nF Statistic              6.165*** (df = 2; 10167)  \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_sell_2 <- lm(hft_sell ~ `return_type_above 2%` + `return_type_below -2%`, data = data_sell_1)\r\nstargazer(model_sell_2, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.189***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`           -0.052           \r\n                                  (0.034)          \r\n                                                   \r\nConstant                          0.027**          \r\n                                  (0.011)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.004           \r\nAdjusted R2                        0.004           \r\nResidual Std. Error         0.998 (df = 10167)     \r\nF Statistic              19.030*** (df = 2; 10167) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\ndata_sell_2 <- data %>% \r\n  select(hft_sell, return, volume, liquidity, volatility) %>% \r\n  mutate(\r\n    return_type=case_when(\r\n      return <= -0.05 ~ \"below -5%\",\r\n      return > 0.05 ~ \"above 5%\",\r\n      return <= -0.02 ~ \"below -2%\",\r\n      return > 0.02 ~ \"above 2%\"\r\n    )\r\n  ) %>% \r\n  mutate(hft_sell = (hft_sell - mean(hft_sell)) / sd(hft_sell),\r\n         volume = (volume - mean(volume)) / sd(volume),\r\n         liquidity =(liquidity - mean(liquidity)) / sd(liquidity)) %>% \r\n  fastDummies::dummy_cols(.) %>% \r\n  mutate_if(is.numeric, ~replace_na(., 0))\r\n\r\nmodel_sell_3 <- lm(hft_sell ~ `return_type_above 5%` + `return_type_below -5%` + \r\n                     volume + liquidity + volatility, data = data_sell_2)\r\nstargazer(model_sell_3, type = \"text\") \r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 5%`            -0.020           \r\n                                  (0.089)          \r\n                                                   \r\n`return_type_below -5%`          0.397***          \r\n                                  (0.099)          \r\n                                                   \r\nvolume                           -0.222***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.007           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                       -2.537***         \r\n                                  (0.693)          \r\n                                                   \r\nConstant                         0.063***          \r\n                                  (0.020)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.051           \r\nAdjusted R2                        0.051           \r\nResidual Std. Error         0.974 (df = 10164)     \r\nF Statistic             109.717*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nmodel_sell_4 <- lm(hft_sell ~ `return_type_above 2%` + `return_type_below -2%` + \r\n                     volume + liquidity + volatility, data = data_sell_2)\r\nstargazer(model_sell_4, type = \"text\")\r\n\r\n\r\n\r\n===================================================\r\n                            Dependent variable:    \r\n                        ---------------------------\r\n                                 hft_sell          \r\n---------------------------------------------------\r\n`return_type_above 2%`           -0.134***         \r\n                                  (0.031)          \r\n                                                   \r\n`return_type_below -2%`            0.016           \r\n                                  (0.035)          \r\n                                                   \r\nvolume                           -0.222***         \r\n                                  (0.014)          \r\n                                                   \r\nliquidity                          0.008           \r\n                                  (0.014)          \r\n                                                   \r\nvolatility                        -1.232*          \r\n                                  (0.629)          \r\n                                                   \r\nConstant                          0.047**          \r\n                                  (0.019)          \r\n                                                   \r\n---------------------------------------------------\r\nObservations                      10,170           \r\nR2                                 0.052           \r\nAdjusted R2                        0.051           \r\nResidual Std. Error         0.974 (df = 10164)     \r\nF Statistic             110.402*** (df = 5; 10164) \r\n===================================================\r\nNote:                   *p<0.1; **p<0.05; ***p<0.01\r\n\r\nAs a result;\r\nLower HFT activity was observed on stocks and days with extreme price\r\nmovements.\r\nHFT decreased on the sell side during positive extreme price\r\nmovements.\r\nHFT decreased on the buy side during negative extreme price\r\nmovements\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-05-08-hft-en/hft-en_files/figure-html5/unnamed-chunk-8-1.png",
    "last_modified": "2022-05-08T22:38:46+03:00",
    "input_file": {}
  }
]
